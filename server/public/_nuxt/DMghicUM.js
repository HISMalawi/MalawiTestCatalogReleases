import{_ as q}from"./DVOtJaNl.js";import{_ as h}from"./BXFRxcxa.js";import{_ as C}from"./fOVD2dkZ.js";import{_ as $}from"./NlL6ZmLo.js";import{d as B,u as P,r as u,c as k,b as x,e as m,f as o,g as N,k as a,l as T}from"./PjMfiYHK.js";import{u as L}from"./CWorKg9L.js";import"./Ste0I7My.js";const A={class:"min-h-screen bg-gray-50 p-5"},F={class:"mx-auto"},E={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},I={class:"w-full py-5 px-5"},S={class:"w-full grid grid-cols-2 gap-5"},Q=B({__name:"create",setup(H){L({title:"Create User | Malawi Test Catalog"});const{$metadata:_,$toast:i,$api:w}=P(),d=u(!1),c=u(!1),l=u("");let f;const e=u({id:0,username:"",app_name:"",email:"",partner:"",location:"",password:"",password_confirmation:"",created_at:"",updated_at:""}),g={fields:[{name:"username",label:"Username",rules:{required:!0,minLength:4}},{name:"app_name",label:"Full Name",rules:{required:!0}},{name:"email",label:"Email",rules:{required:!0,email:!0}},{name:"partner",label:"Partner",rules:{required:!0}},{name:"location",label:"Location",rules:{required:!1}},{name:"password",label:"Password",rules:{required:!0,minLength:6}},{name:"password_confirmation",label:"Confirm Password",rules:{required:!0,minLength:6}}]},v=async(t,r)=>{if(e.value.password!==e.value.password_confirmation){i.error("Passwords do not match");return}d.value=!0;try{await _.users.create(e.value)&&(i.success("User created successfully"),setTimeout(()=>{T({path:"/app/users"})},2e3))}catch{i.error("An error occurred while creating user")}finally{d.value=!1}},b=()=>{clearTimeout(f),l.value="",f=setTimeout(()=>{V()},1e3)},V=async()=>{if(!e.value.username||e.value.username.trim()===""){l.value="";return}c.value=!0,l.value="";try{const t=await w.get(`users/check_username/${e.value.username}`);l.value=""}catch(t){t.status===422&&(l.value=t.data.message)}finally{c.value=!1}};return(t,r)=>{const p=q,n=h,y=C,U=$;return x(),k("div",A,[m("div",F,[m("div",E,[o(p,{icon:"mdi:account-plus-outline",title:"Create New User",description:"Add details of a new user account"}),m("div",I,[o(U,{config:g,onSubmit:v},{default:N(({form:M})=>[m("div",S,[o(n,{name:"username",label:"Username",modelValue:a(e).username,"onUpdate:modelValue":r[0]||(r[0]=s=>a(e).username=s),"error-message":a(l),required:"",onInput:b},null,8,["modelValue","error-message"]),o(n,{name:"app_name",label:"Full Name",modelValue:a(e).app_name,"onUpdate:modelValue":r[1]||(r[1]=s=>a(e).app_name=s),required:""},null,8,["modelValue"]),o(n,{name:"partner",label:"Partner",modelValue:a(e).partner,"onUpdate:modelValue":r[2]||(r[2]=s=>a(e).partner=s),required:""},null,8,["modelValue"]),o(n,{name:"location",label:"Location",modelValue:a(e).location,"onUpdate:modelValue":r[3]||(r[3]=s=>a(e).location=s),required:""},null,8,["modelValue"]),o(n,{name:"password",label:"Password",type:"password",modelValue:a(e).password,"onUpdate:modelValue":r[4]||(r[4]=s=>a(e).password=s),required:""},null,8,["modelValue"]),o(n,{name:"password_confirmation",label:"Confirm Password",type:"password",modelValue:a(e).password_confirmation,"onUpdate:modelValue":r[5]||(r[5]=s=>a(e).password_confirmation=s),required:""},null,8,["modelValue"])]),o(y,{class:"mt-4",label:"Submit",loading:a(d),type:"submit"},null,8,["loading"])]),_:1})])])])])}}});export{Q as default};
