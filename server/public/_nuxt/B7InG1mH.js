import{_ as A}from"./Bcsf2iPY.js";import{_ as E}from"./Bf0aH3QM.js";import{_ as M}from"./Cf3ca5Xh.js";import{d as D,u as I,r as _,z as V,p as H,o as R,k as w,c as y,b as d,e as t,v as T,q as f,f as r,l as a,s as O,m as g,g as i,t as j}from"./DSPXqrpM.js";import{u as F}from"./BxMKpl0t.js";import{u as U}from"./CnpgD76R.js";import"./eA2H0pyo.js";import"./BhFxkj3L.js";import"./CyCQu6eQ.js";const q={class:"px-4 py-8"},z={class:"w-full flex items-center justify-between bg-white border border-gray-100 rounded my-2 px-4 py-2"},Y={class:"w-80"},G={class:"overflow-hidden"},J=["innerHTML"],K={class:"line-clamp-1"},Q={class:"flex items-center space-x-3"},W=["onClick"],X=["onClick"],Z={class:"cursor-pointer"},de=D({__name:"index",setup(ee){F({title:"Test Panels | Malawi Test Catalog"});const{$metadata:C,$toast:b}=I(),{canEdit:p}=U(),u=_(!1),l=_([]),n=_(""),k=[{text:"NAME",value:"name"},{text:"SHORT NAME",value:"short_name"},{text:"DESCRIPTION",value:"description"},{text:"TEST TYPES",value:"test_types"},{text:"ACTIONS",value:"actions"}],c=V({currentPage:1,perPage:10,total:0}),x=H(()=>n.value?l.value.filter(e=>e.name.toLowerCase().includes(n.value.toLowerCase())||e.short_name.toLowerCase().includes(n.value.toLowerCase())||e.description&&e.description.toLowerCase().includes(n.value.toLowerCase())):l.value),h=async()=>{u.value=!0;try{const e=await C.test_panels.getAll();l.value=e.data||e,c.total=l.value.length}catch(e){console.error("Failed to fetch test panels:",e),b.error("Failed to fetch test panels")}finally{u.value=!1}},P=e=>{c.currentPage=e},$=async()=>{await h()};return R(h),(e,o)=>{const N=A,B=E,m=w("Icon"),L=M,S=w("datatable");return d(),y("div",q,[o[3]||(o[3]=t("div",null,[t("h1",{class:"text-3xl font-semibold py-4"},"Test Panels")],-1)),t("div",z,[t("div",Y,[r(N,{modelValue:a(n),"onUpdate:modelValue":o[0]||(o[0]=s=>O(n)?n.value=s:null),placeholder:"Search test panels..."},null,8,["modelValue"])]),a(p)?(d(),T(B,{key:0,"icon-start":"mdi:plus",onClick:o[1]||(o[1]=s=>("navigateTo"in e?e.navigateTo:a(g))("/app/test-panels/create")),label:"Add Test Panel"})):f("",!0)]),t("div",G,[r(S,{"table-class-name":"datatable",headers:k,items:a(x),loading:a(u),"current-page":a(c).currentPage,"rows-per-page":a(c).perPage,"onUpdate:currentPage":P},{loading:i(()=>o[2]||(o[2]=[t("svg",{class:"w-15 h-15 text-emerald-600",width:"38",height:"38",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"oklch(0.596 0.145 163.225)"},[t("g",{fill:"none","fill-rule":"evenodd"},[t("g",{transform:"translate(1 1)","stroke-width":"2"},[t("circle",{"stroke-opacity":".5",cx:"18",cy:"18",r:"18"}),t("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[t("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})])])])],-1)])),"item-description":i(s=>[t("div",{innerHTML:s.description},null,8,J)]),"item-test_types":i(s=>[t("div",K,j(s.test_types!==null&&s.test_types.map(v=>v.name).join(", ")),1)]),"item-actions":i(s=>[t("div",Q,[t("button",{onClick:v=>("navigateTo"in e?e.navigateTo:a(g))(`/app/test-panels/view?id=${s.id}`),class:"cursor-pointer"},[r(m,{icon:"lets-icons:view-alt-duotone",class:"w-5 h-5 mr-1"})],8,W),a(p)?(d(),y("button",{key:0,onClick:v=>("navigateTo"in e?e.navigateTo:a(g))(`/app/test-panels/update?id=${s.id}`),class:"cursor-pointer"},[r(m,{icon:"fa:edit",class:"w-5 h-5"})],8,X)):f("",!0),a(p)?(d(),T(L,{key:1,property:{id:s.id,name:"test panels",endpoint:"test_panels"},onConfirm:$},{default:i(()=>[t("button",Z,[r(m,{icon:"mdi:delete",class:"w-5 h-5 mr-1"})])]),_:2},1032,["property"])):f("",!0)])]),_:1},8,["items","loading","current-page","rows-per-page"])])])}}});export{de as default};
