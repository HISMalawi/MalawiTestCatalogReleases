import{_ as yt}from"./B-WsDPk8.js";import{_ as wt}from"./Bcsf2iPY.js";import{_ as _t}from"./Cf3ca5Xh.js";import{p as A,l as _,N as St,w as X,O as je,P as Ot,r as M,E as Re,d as Q,o as ye,Q as me,R as _e,h as J,F as ue,z as It,S as se,n as pe,K as Me,T as Ct,c as j,b as N,e as s,k as Pe,J as Et,f as B,i as ve,g as L,t as U,q as W,C as ee,U as Tt,A as Ce,v as Ie,u as Ae,j as Rt,V as Mt,s as oe,W as kt,H as Se,X as Oe,_ as $t}from"./DSPXqrpM.js";import{d as he}from"./BtSipvlV.js";import{o as Fe,f as Ee,u as Te,t as Le,n as et,q as Pt,N as At,E as Ft,d as ie,S as De,Y as Dt,h as He,G as Vt,V as zt}from"./BhFxkj3L.js";import{u as Bt}from"./BxMKpl0t.js";import{u as Nt}from"./CnpgD76R.js";import{i as ae,a as ke,o as y,A as ce,l as tt,b as de,T as ze,u as Z,w as lt,t as ot,E as jt,O as Lt,c as K,N as xe,n as Ht,d as Be,e as Ut,h as Wt,P as fe,f as Ve,g as re}from"./CyCQu6eQ.js";import{s as at,i as Kt,u as qt,c as q,f as Ue}from"./BSmCdyGv.js";import"./eA2H0pyo.js";import"./Bf0aH3QM.js";import"./Cpj98o6Y.js";function ge(o,c,l){let i=l.initialDeps??[],t;return()=>{var r,a,e,b;let v;l.key&&((r=l.debug)!=null&&r.call(l))&&(v=Date.now());const p=o();if(!(p.length!==i.length||p.some((R,$)=>i[$]!==R)))return t;i=p;let T;if(l.key&&((a=l.debug)!=null&&a.call(l))&&(T=Date.now()),t=c(...p),l.key&&((e=l.debug)!=null&&e.call(l))){const R=Math.round((Date.now()-v)*100)/100,$=Math.round((Date.now()-T)*100)/100,D=$/16,V=(k,w)=>{for(k=String(k);k.length<w;)k=" "+k;return k};console.info(`%câ± ${V($,5)} /${V(R,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*D,120))}deg 100% 31%);`,l==null?void 0:l.key)}return(b=l==null?void 0:l.onChange)==null||b.call(l,t),t}}function $e(o,c){if(o===void 0)throw new Error("Unexpected undefined");return o}const Gt=(o,c)=>Math.abs(o-c)<1,Yt=(o,c,l)=>{let i;return function(...t){o.clearTimeout(i),i=o.setTimeout(()=>c.apply(this,t),l)}},Zt=o=>o,Jt=o=>{const c=Math.max(o.startIndex-o.overscan,0),l=Math.min(o.endIndex+o.overscan,o.count-1),i=[];for(let t=c;t<=l;t++)i.push(t);return i},Xt=(o,c)=>{const l=o.scrollElement;if(!l)return;const i=o.targetWindow;if(!i)return;const t=a=>{const{width:e,height:b}=a;c({width:Math.round(e),height:Math.round(b)})};if(t(l.getBoundingClientRect()),!i.ResizeObserver)return()=>{};const r=new i.ResizeObserver(a=>{const e=()=>{const b=a[0];if(b!=null&&b.borderBoxSize){const v=b.borderBoxSize[0];if(v){t({width:v.inlineSize,height:v.blockSize});return}}t(l.getBoundingClientRect())};o.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(e):e()});return r.observe(l,{box:"border-box"}),()=>{r.unobserve(l)}},We={passive:!0},Ke=typeof window>"u"?!0:"onscrollend"in window,Qt=(o,c)=>{const l=o.scrollElement;if(!l)return;const i=o.targetWindow;if(!i)return;let t=0;const r=o.options.useScrollendEvent&&Ke?()=>{}:Yt(i,()=>{c(t,!1)},o.options.isScrollingResetDelay),a=p=>()=>{const{horizontal:h,isRtl:T}=o.options;t=h?l.scrollLeft*(T&&-1||1):l.scrollTop,r(),c(t,p)},e=a(!0),b=a(!1);b(),l.addEventListener("scroll",e,We);const v=o.options.useScrollendEvent&&Ke;return v&&l.addEventListener("scrollend",b,We),()=>{l.removeEventListener("scroll",e),v&&l.removeEventListener("scrollend",b)}},el=(o,c,l)=>{if(c!=null&&c.borderBoxSize){const i=c.borderBoxSize[0];if(i)return Math.round(i[l.options.horizontal?"inlineSize":"blockSize"])}return Math.round(o.getBoundingClientRect()[l.options.horizontal?"width":"height"])},tl=(o,{adjustments:c=0,behavior:l},i)=>{var t,r;const a=o+c;(r=(t=i.scrollElement)==null?void 0:t.scrollTo)==null||r.call(t,{[i.options.horizontal?"left":"top"]:a,behavior:l})};class ll{constructor(c){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let l=null;const i=()=>l||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:l=new this.targetWindow.ResizeObserver(t=>{t.forEach(r=>{const a=()=>{this._measureElement(r.target,r)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var t;(t=i())==null||t.disconnect(),l=null},observe:t=>{var r;return(r=i())==null?void 0:r.observe(t,{box:"border-box"})},unobserve:t=>{var r;return(r=i())==null?void 0:r.unobserve(t)}}})(),this.range=null,this.setOptions=l=>{Object.entries(l).forEach(([i,t])=>{typeof t>"u"&&delete l[i]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Zt,rangeExtractor:Jt,onChange:()=>{},measureElement:el,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!0,useAnimationFrameWithResizeObserver:!1,...l}},this.notify=l=>{var i,t;(t=(i=this.options).onChange)==null||t.call(i,this,l)},this.maybeNotify=ge(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),l=>{this.notify(l)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(l=>l()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var l;const i=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==i){if(this.cleanup(),!i){this.maybeNotify();return}this.scrollElement=i,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((l=this.scrollElement)==null?void 0:l.window)??null,this.elementsCache.forEach(t=>{this.observer.observe(t)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(t,r)=>{this.scrollAdjustments=0,this.scrollDirection=r?this.getScrollOffset()<t?"forward":"backward":null,this.scrollOffset=t,this.isScrolling=r,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(l,i)=>{const t=new Map,r=new Map;for(let a=i-1;a>=0;a--){const e=l[a];if(t.has(e.lane))continue;const b=r.get(e.lane);if(b==null||e.end>b.end?r.set(e.lane,e):e.end<b.end&&t.set(e.lane,!0),t.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((a,e)=>a.end===e.end?a.index-e.index:a.end-e.end)[0]:void 0},this.getMeasurementOptions=ge(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(l,i,t,r,a)=>(this.pendingMeasuredCacheIndexes=[],{count:l,paddingStart:i,scrollMargin:t,getItemKey:r,enabled:a}),{key:!1}),this.getMeasurements=ge(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:l,paddingStart:i,scrollMargin:t,getItemKey:r,enabled:a},e)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(p=>{this.itemSizeCache.set(p.key,p.size)}));const b=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,b);for(let p=b;p<l;p++){const h=r(p),T=this.options.lanes===1?v[p-1]:this.getFurthestMeasurement(v,p),R=T?T.end+this.options.gap:i+t,$=e.get(h),D=typeof $=="number"?$:this.options.estimateSize(p),V=R+D,k=T?T.lane:p%this.options.lanes;v[p]={index:p,start:R,size:D,end:V,key:h,lane:k}}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ge(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(l,i,t,r)=>this.range=l.length>0&&i>0?ol({measurements:l,outerSize:i,scrollOffset:t,lanes:r}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=ge(()=>{let l=null,i=null;const t=this.calculateRange();return t&&(l=t.startIndex,i=t.endIndex),[this.options.rangeExtractor,this.options.overscan,this.options.count,l,i]},(l,i,t,r,a)=>r===null||a===null?[]:l({startIndex:r,endIndex:a,overscan:i,count:t}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=l=>{const i=this.options.indexAttribute,t=l.getAttribute(i);return t?parseInt(t,10):(console.warn(`Missing attribute name '${i}={index}' on measured element.`),-1)},this._measureElement=(l,i)=>{const t=this.indexFromElement(l),r=this.measurementsCache[t];if(!r)return;const a=r.key,e=this.elementsCache.get(a);e!==l&&(e&&this.observer.unobserve(e),this.observer.observe(l),this.elementsCache.set(a,l)),l.isConnected&&this.resizeItem(t,this.options.measureElement(l,i,this))},this.resizeItem=(l,i)=>{const t=this.measurementsCache[l];if(!t)return;const r=this.itemSizeCache.get(t.key)??t.size,a=i-r;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,a,this):t.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,i)),this.notify(!1))},this.measureElement=l=>{if(!l){this.elementsCache.forEach((i,t)=>{i.isConnected||(this.observer.unobserve(i),this.elementsCache.delete(t))});return}this._measureElement(l,void 0)},this.getVirtualItems=ge(()=>[this.getVirtualIndexes(),this.getMeasurements()],(l,i)=>{const t=[];for(let r=0,a=l.length;r<a;r++){const e=l[r],b=i[e];t.push(b)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=l=>{const i=this.getMeasurements();if(i.length!==0)return $e(i[nt(0,i.length-1,t=>$e(i[t]).start,l)])},this.getOffsetForAlignment=(l,i,t=0)=>{const r=this.getSize(),a=this.getScrollOffset();i==="auto"&&(i=l>=a+r?"end":"start"),i==="center"?l+=(t-r)/2:i==="end"&&(l-=r);const e=this.options.horizontal?"scrollWidth":"scrollHeight",v=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[e]:this.scrollElement[e]:0)-r;return Math.max(Math.min(v,l),0)},this.getOffsetForIndex=(l,i="auto")=>{l=Math.max(0,Math.min(l,this.options.count-1));const t=this.measurementsCache[l];if(!t)return;const r=this.getSize(),a=this.getScrollOffset();if(i==="auto")if(t.end>=a+r-this.options.scrollPaddingEnd)i="end";else if(t.start<=a+this.options.scrollPaddingStart)i="start";else return[a,i];const e=i==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(e,i,t.size),i]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(l,{align:i="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(l,i),{adjustments:void 0,behavior:t})},this.scrollToIndex=(l,{align:i="auto",behavior:t}={})=>{l=Math.max(0,Math.min(l,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(l,i);if(!r)return;const[a,e]=r;this._scrollToOffset(a,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(l))){const[v]=$e(this.getOffsetForIndex(l,e));Gt(v,this.getScrollOffset())||this.scrollToIndex(l,{align:e,behavior:t})}else this.scrollToIndex(l,{align:e,behavior:t})}))},this.scrollBy=(l,{behavior:i}={})=>{this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+l,{adjustments:void 0,behavior:i})},this.getTotalSize=()=>{var l;const i=this.getMeasurements();let t;return i.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((l=i[i.length-1])==null?void 0:l.end)??0:Math.max(...i.slice(-this.options.lanes).map(r=>r.end)),Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(l,{adjustments:i,behavior:t})=>{this.options.scrollToFn(l,{behavior:t,adjustments:i},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(c)}}const nt=(o,c,l,i)=>{for(;o<=c;){const t=(o+c)/2|0,r=l(t);if(r<i)o=t+1;else if(r>i)c=t-1;else return t}return o>0?o-1:0};function ol({measurements:o,outerSize:c,scrollOffset:l,lanes:i}){const t=o.length-1;let a=nt(0,t,b=>o[b].start,l),e=a;for(;e<t&&o[e].end<l+c;)e++;return i>1&&(a=Math.max(0,a-a%i),e=Math.min(t,e+(i-1-e%i))),{startIndex:a,endIndex:e}}function al(o){const c=new ll(_(o)),l=St(c),i=c._didMount();return X(()=>_(o).getScrollElement(),t=>{t&&c._willUpdate()},{immediate:!0}),X(()=>_(o),t=>{c.setOptions({...t,onChange:(r,a)=>{var e;je(l),(e=t.onChange)==null||e.call(t,r,a)}}),c._willUpdate(),je(l)},{immediate:!0}),Ot(i),l}function nl(o){return al(A(()=>({observeElementRect:Xt,observeElementOffset:Qt,scrollToFn:tl,..._(o)})))}function sl(o,c,l){let i=M(l==null?void 0:l.value),t=A(()=>o.value!==void 0);return[A(()=>t.value?o.value:i.value),function(r){return t.value||(i.value=r),c==null?void 0:c(r)}]}function il(){let o=Fe();return Re(()=>o.dispose()),o}function rl(){let o=il();return c=>{o.dispose(),o.nextFrame(c)}}var st=(o=>(o[o.Left=0]="Left",o[o.Right=2]="Right",o))(st||{});function it(o={},c=null,l=[]){for(let[i,t]of Object.entries(o))ut(l,rt(c,i),t);return l}function rt(o,c){return o?o+"["+c+"]":c}function ut(o,c,l){if(Array.isArray(l))for(let[i,t]of l.entries())ut(o,rt(c,i.toString()),t);else l instanceof Date?o.push([c,l.toISOString()]):typeof l=="boolean"?o.push([c,l?"1":"0"]):typeof l=="string"?o.push([c,l]):typeof l=="number"?o.push([c,`${l}`]):l==null?o.push([c,""]):it(l,c,o)}var ul={};function dl(o,c){return o===c}var cl=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(cl||{}),pl=(o=>(o[o.Single=0]="Single",o[o.Multi=1]="Multi",o))(pl||{}),vl=(o=>(o[o.Pointer=0]="Pointer",o[o.Focus=1]="Focus",o[o.Other=2]="Other",o))(vl||{});let dt=Symbol("ComboboxContext");function we(o){let c=_e(dt,null);if(c===null){let l=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,we),l}return c}let ct=Symbol("VirtualContext"),fl=Q({name:"VirtualProvider",setup(o,{slots:c}){let l=we("VirtualProvider"),i=A(()=>{let e=y(l.optionsRef);if(!e)return{start:0,end:0};let b=window.getComputedStyle(e);return{start:parseFloat(b.paddingBlockStart||b.paddingTop),end:parseFloat(b.paddingBlockEnd||b.paddingBottom)}}),t=nl(A(()=>({scrollPaddingStart:i.value.start,scrollPaddingEnd:i.value.end,count:l.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return y(l.optionsRef)},overscan:12}))),r=A(()=>{var e;return(e=l.virtual.value)==null?void 0:e.options}),a=M(0);return X([r],()=>{a.value+=1}),Me(ct,l.virtual.value?t:null),()=>[J("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:e=>{if(e){if(typeof process<"u"&&ul.JEST_WORKER_ID!==void 0||l.activationTrigger.value===0)return;l.activeOptionIndex.value!==null&&l.virtual.value.options.length>l.activeOptionIndex.value&&t.value.scrollToIndex(l.activeOptionIndex.value)}}},t.value.getVirtualItems().map(e=>Ct(c.default({option:l.virtual.value.options[e.index],open:l.comboboxState.value===0})[0],{key:`${a.value}-${e.index}`,"data-index":e.index,"aria-setsize":l.virtual.value.options.length,"aria-posinset":e.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${e.start}px)`,overflowAnchor:"none"}})))]}}),qe=Q({name:"Combobox",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(o,{slots:c,attrs:l,emit:i}){let t=M(1),r=M(null),a=M(null),e=M(null),b=M(null),v=M({static:!1,hold:!1}),p=M([]),h=M(null),T=M(2),R=M(!1);function $(d=x=>x){let x=h.value!==null?p.value[h.value]:null,P=d(p.value.slice()),F=P.length>0&&P[0].dataRef.order.value!==null?P.sort((H,Y)=>H.dataRef.order.value-Y.dataRef.order.value):Lt(P,H=>y(H.dataRef.domRef)),z=x?F.indexOf(x):null;return z===-1&&(z=null),{options:F,activeOptionIndex:z}}let D=A(()=>o.multiple?1:0),V=A(()=>o.nullable),[k,w]=sl(A(()=>o.modelValue),d=>i("update:modelValue",d),A(()=>o.defaultValue)),I=A(()=>k.value===void 0?Z(D.value,{1:[],0:void 0}):k.value),S=null,n=null;function g(d){return Z(D.value,{0(){return w==null?void 0:w(d)},1:()=>{let x=se(u.value.value).slice(),P=se(d),F=x.findIndex(z=>u.compare(P,se(z)));return F===-1?x.push(P):x.splice(F,1),w==null?void 0:w(x)}})}let f=A(()=>{});X([f],([d],[x])=>{if(u.virtual.value&&d&&x&&h.value!==null){let P=d.indexOf(x[h.value]);P!==-1?h.value=P:h.value=null}});let u={comboboxState:t,value:I,mode:D,compare(d,x){if(typeof o.by=="string"){let P=o.by;return(d==null?void 0:d[P])===(x==null?void 0:x[P])}return o.by===null?dl(d,x):o.by(d,x)},calculateIndex(d){return u.virtual.value?o.by===null?u.virtual.value.options.indexOf(d):u.virtual.value.options.findIndex(x=>u.compare(x,d)):p.value.findIndex(x=>u.compare(x.dataRef.value,d))},defaultValue:A(()=>o.defaultValue),nullable:V,immediate:A(()=>!1),virtual:A(()=>null),inputRef:a,labelRef:r,buttonRef:e,optionsRef:b,disabled:A(()=>o.disabled),options:p,change(d){w(d)},activeOptionIndex:A(()=>{if(R.value&&h.value===null&&(u.virtual.value?u.virtual.value.options.length>0:p.value.length>0)){if(u.virtual.value){let x=u.virtual.value.options.findIndex(P=>{var F;return!((F=u.virtual.value)!=null&&F.disabled(P))});if(x!==-1)return x}let d=p.value.findIndex(x=>!x.dataRef.disabled);if(d!==-1)return d}return h.value}),activationTrigger:T,optionsPropsRef:v,closeCombobox(){R.value=!1,!o.disabled&&t.value!==1&&(t.value=1,h.value=null)},openCombobox(){if(R.value=!0,!o.disabled&&t.value!==0){if(u.value.value){let d=u.calculateIndex(u.value.value);d!==-1&&(h.value=d)}t.value=0}},setActivationTrigger(d){T.value=d},goToOption(d,x,P){R.value=!1,S!==null&&cancelAnimationFrame(S),S=requestAnimationFrame(()=>{if(o.disabled||b.value&&!v.value.static&&t.value===1)return;if(u.virtual.value){h.value=d===q.Specific?x:Ue({focus:d},{resolveItems:()=>u.virtual.value.options,resolveActiveIndex:()=>{var H,Y;return(Y=(H=u.activeOptionIndex.value)!=null?H:u.virtual.value.options.findIndex(ne=>{var C;return!((C=u.virtual.value)!=null&&C.disabled(ne))}))!=null?Y:null},resolveDisabled:H=>u.virtual.value.disabled(H),resolveId(){throw new Error("Function not implemented.")}}),T.value=P??2;return}let F=$();if(F.activeOptionIndex===null){let H=F.options.findIndex(Y=>!Y.dataRef.disabled);H!==-1&&(F.activeOptionIndex=H)}let z=d===q.Specific?x:Ue({focus:d},{resolveItems:()=>F.options,resolveActiveIndex:()=>F.activeOptionIndex,resolveId:H=>H.id,resolveDisabled:H=>H.dataRef.disabled});h.value=z,T.value=P??2,p.value=F.options})},selectOption(d){let x=p.value.find(F=>F.id===d);if(!x)return;let{dataRef:P}=x;g(P.value)},selectActiveOption(){if(u.activeOptionIndex.value!==null){if(u.virtual.value)g(u.virtual.value.options[u.activeOptionIndex.value]);else{let{dataRef:d}=p.value[u.activeOptionIndex.value];g(d.value)}u.goToOption(q.Specific,u.activeOptionIndex.value)}},registerOption(d,x){let P=It({id:d,dataRef:x});if(u.virtual.value){p.value.push(P);return}n&&cancelAnimationFrame(n);let F=$(z=>(z.push(P),z));h.value===null&&u.isSelected(x.value.value)&&(F.activeOptionIndex=F.options.indexOf(P)),p.value=F.options,h.value=F.activeOptionIndex,T.value=2,F.options.some(z=>!y(z.dataRef.domRef))&&(n=requestAnimationFrame(()=>{let z=$();p.value=z.options,h.value=z.activeOptionIndex}))},unregisterOption(d,x){if(S!==null&&cancelAnimationFrame(S),x&&(R.value=!0),u.virtual.value){p.value=p.value.filter(F=>F.id!==d);return}let P=$(F=>{let z=F.findIndex(H=>H.id===d);return z!==-1&&F.splice(z,1),F});p.value=P.options,h.value=P.activeOptionIndex,T.value=2},isSelected(d){return Z(D.value,{0:()=>u.compare(se(u.value.value),se(d)),1:()=>se(u.value.value).some(x=>u.compare(se(x),se(d)))})},isActive(d){return h.value===u.calculateIndex(d)}};lt([a,e,b],()=>u.closeCombobox(),A(()=>t.value===0)),Me(dt,u),ot(A(()=>Z(t.value,{0:de.Open,1:de.Closed})));let O=A(()=>{var d;return(d=y(a))==null?void 0:d.closest("form")});return ye(()=>{X([O],()=>{if(!O.value||o.defaultValue===void 0)return;function d(){u.change(o.defaultValue)}return O.value.addEventListener("reset",d),()=>{var x;(x=O.value)==null||x.removeEventListener("reset",d)}},{immediate:!0})}),()=>{var d,x,P;let{name:F,disabled:z,form:H,...Y}=o,ne={open:t.value===0,disabled:z,activeIndex:u.activeOptionIndex.value,activeOption:u.activeOptionIndex.value===null?null:u.virtual.value?u.virtual.value.options[(d=u.activeOptionIndex.value)!=null?d:0]:(P=(x=u.options.value[u.activeOptionIndex.value])==null?void 0:x.dataRef.value)!=null?P:null,value:I.value};return J(ue,[...F!=null&&I.value!=null?it({[F]:I.value}).map(([C,m])=>J(Ee,jt({features:Te.Hidden,key:C,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:H,disabled:z,name:C,value:m}))):[],ce({theirProps:{...l,...ze(Y,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:ne,slots:c,attrs:l,name:"Combobox"})])}}}),Ge=Q({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(o,{attrs:c,slots:l,expose:i}){var t;let r=(t=o.id)!=null?t:`headlessui-combobox-button-${ae()}`,a=we("ComboboxButton");i({el:a.buttonRef,$el:a.buttonRef});function e(p){a.disabled.value||(a.comboboxState.value===0?a.closeCombobox():(p.preventDefault(),a.openCombobox()),pe(()=>{var h;return(h=y(a.inputRef))==null?void 0:h.focus({preventScroll:!0})}))}function b(p){switch(p.key){case K.ArrowDown:p.preventDefault(),p.stopPropagation(),a.comboboxState.value===1&&a.openCombobox(),pe(()=>{var h;return(h=a.inputRef.value)==null?void 0:h.focus({preventScroll:!0})});return;case K.ArrowUp:p.preventDefault(),p.stopPropagation(),a.comboboxState.value===1&&(a.openCombobox(),pe(()=>{a.value.value||a.goToOption(q.Last)})),pe(()=>{var h;return(h=a.inputRef.value)==null?void 0:h.focus({preventScroll:!0})});return;case K.Escape:if(a.comboboxState.value!==0)return;p.preventDefault(),a.optionsRef.value&&!a.optionsPropsRef.value.static&&p.stopPropagation(),a.closeCombobox(),pe(()=>{var h;return(h=a.inputRef.value)==null?void 0:h.focus({preventScroll:!0})});return}}let v=at(A(()=>({as:o.as,type:c.type})),a.buttonRef);return()=>{var p,h;let T={open:a.comboboxState.value===0,disabled:a.disabled.value,value:a.value.value},{...R}=o,$={ref:a.buttonRef,id:r,type:v.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(p=y(a.optionsRef))==null?void 0:p.id,"aria-expanded":a.comboboxState.value===0,"aria-labelledby":a.labelRef.value?[(h=y(a.labelRef))==null?void 0:h.id,r].join(" "):void 0,disabled:a.disabled.value===!0?!0:void 0,onKeydown:b,onClick:e};return ce({ourProps:$,theirProps:R,slot:T,attrs:c,slots:l,name:"ComboboxButton"})}}}),Ye=Q({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:o=>!0},setup(o,{emit:c,attrs:l,slots:i,expose:t}){var r;let a=(r=o.id)!=null?r:`headlessui-combobox-input-${ae()}`,e=we("ComboboxInput"),b=A(()=>ke(y(e.inputRef))),v={value:!1};t({el:e.inputRef,$el:e.inputRef});function p(){e.change(null);let n=y(e.optionsRef);n&&(n.scrollTop=0),e.goToOption(q.Nothing)}let h=A(()=>{var n;let g=e.value.value;return y(e.inputRef)?typeof o.displayValue<"u"&&g!==void 0?(n=o.displayValue(g))!=null?n:"":typeof g=="string"?g:"":""});ye(()=>{X([h,e.comboboxState,b],([n,g],[f,u])=>{if(v.value)return;let O=y(e.inputRef);O&&((u===0&&g===1||n!==f)&&(O.value=n),requestAnimationFrame(()=>{var d;if(v.value||!O||((d=b.value)==null?void 0:d.activeElement)!==O)return;let{selectionStart:x,selectionEnd:P}=O;Math.abs((P??0)-(x??0))===0&&x===0&&O.setSelectionRange(O.value.length,O.value.length)}))},{immediate:!0}),X([e.comboboxState],([n],[g])=>{if(n===0&&g===1){if(v.value)return;let f=y(e.inputRef);if(!f)return;let u=f.value,{selectionStart:O,selectionEnd:d,selectionDirection:x}=f;f.value="",f.value=u,x!==null?f.setSelectionRange(O,d,x):f.setSelectionRange(O,d)}})});let T=M(!1);function R(){T.value=!0}function $(){Fe().nextFrame(()=>{T.value=!1})}let D=rl();function V(n){switch(v.value=!0,D(()=>{v.value=!1}),n.key){case K.Enter:if(v.value=!1,e.comboboxState.value!==0||T.value)return;if(n.preventDefault(),n.stopPropagation(),e.activeOptionIndex.value===null){e.closeCombobox();return}e.selectActiveOption(),e.mode.value===0&&e.closeCombobox();break;case K.ArrowDown:return v.value=!1,n.preventDefault(),n.stopPropagation(),Z(e.comboboxState.value,{0:()=>e.goToOption(q.Next),1:()=>e.openCombobox()});case K.ArrowUp:return v.value=!1,n.preventDefault(),n.stopPropagation(),Z(e.comboboxState.value,{0:()=>e.goToOption(q.Previous),1:()=>{e.openCombobox(),pe(()=>{e.value.value||e.goToOption(q.Last)})}});case K.Home:if(n.shiftKey)break;return v.value=!1,n.preventDefault(),n.stopPropagation(),e.goToOption(q.First);case K.PageUp:return v.value=!1,n.preventDefault(),n.stopPropagation(),e.goToOption(q.First);case K.End:if(n.shiftKey)break;return v.value=!1,n.preventDefault(),n.stopPropagation(),e.goToOption(q.Last);case K.PageDown:return v.value=!1,n.preventDefault(),n.stopPropagation(),e.goToOption(q.Last);case K.Escape:if(v.value=!1,e.comboboxState.value!==0)return;n.preventDefault(),e.optionsRef.value&&!e.optionsPropsRef.value.static&&n.stopPropagation(),e.nullable.value&&e.mode.value===0&&e.value.value===null&&p(),e.closeCombobox();break;case K.Tab:if(v.value=!1,e.comboboxState.value!==0)return;e.mode.value===0&&e.activationTrigger.value!==1&&e.selectActiveOption(),e.closeCombobox();break}}function k(n){c("change",n),e.nullable.value&&e.mode.value===0&&n.target.value===""&&p(),e.openCombobox()}function w(n){var g,f,u;let O=(g=n.relatedTarget)!=null?g:Le.find(d=>d!==n.currentTarget);if(v.value=!1,!((f=y(e.optionsRef))!=null&&f.contains(O))&&!((u=y(e.buttonRef))!=null&&u.contains(O))&&e.comboboxState.value===0)return n.preventDefault(),e.mode.value===0&&(e.nullable.value&&e.value.value===null?p():e.activationTrigger.value!==1&&e.selectActiveOption()),e.closeCombobox()}function I(n){var g,f,u;let O=(g=n.relatedTarget)!=null?g:Le.find(d=>d!==n.currentTarget);(f=y(e.buttonRef))!=null&&f.contains(O)||(u=y(e.optionsRef))!=null&&u.contains(O)||e.disabled.value||e.immediate.value&&e.comboboxState.value!==0&&(e.openCombobox(),Fe().nextFrame(()=>{e.setActivationTrigger(1)}))}let S=A(()=>{var n,g,f,u;return(u=(f=(g=o.defaultValue)!=null?g:e.defaultValue.value!==void 0?(n=o.displayValue)==null?void 0:n.call(o,e.defaultValue.value):null)!=null?f:e.defaultValue.value)!=null?u:""});return()=>{var n,g,f,u,O,d,x;let P={open:e.comboboxState.value===0},{displayValue:F,onChange:z,...H}=o,Y={"aria-controls":(n=e.optionsRef.value)==null?void 0:n.id,"aria-expanded":e.comboboxState.value===0,"aria-activedescendant":e.activeOptionIndex.value===null?void 0:e.virtual.value?(g=e.options.value.find(ne=>!e.virtual.value.disabled(ne.dataRef.value)&&e.compare(ne.dataRef.value,e.virtual.value.options[e.activeOptionIndex.value])))==null?void 0:g.id:(f=e.options.value[e.activeOptionIndex.value])==null?void 0:f.id,"aria-labelledby":(d=(u=y(e.labelRef))==null?void 0:u.id)!=null?d:(O=y(e.buttonRef))==null?void 0:O.id,"aria-autocomplete":"list",id:a,onCompositionstart:R,onCompositionend:$,onKeydown:V,onInput:k,onFocus:I,onBlur:w,role:"combobox",type:(x=l.type)!=null?x:"text",tabIndex:0,ref:e.inputRef,defaultValue:S.value,disabled:e.disabled.value===!0?!0:void 0};return ce({ourProps:Y,theirProps:H,slot:P,attrs:l,slots:i,features:xe.RenderStrategy|xe.Static,name:"ComboboxInput"})}}}),Ze=Q({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(o,{attrs:c,slots:l,expose:i}){let t=we("ComboboxOptions"),r=`headlessui-combobox-options-${ae()}`;i({el:t.optionsRef,$el:t.optionsRef}),me(()=>{t.optionsPropsRef.value.static=o.static}),me(()=>{t.optionsPropsRef.value.hold=o.hold});let a=tt(),e=A(()=>a!==null?(a.value&de.Open)===de.Open:t.comboboxState.value===0);Kt({container:A(()=>y(t.optionsRef)),enabled:A(()=>t.comboboxState.value===0),accept(v){return v.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}});function b(v){v.preventDefault()}return()=>{var v,p,h;let T={open:t.comboboxState.value===0},R={"aria-labelledby":(h=(v=y(t.labelRef))==null?void 0:v.id)!=null?h:(p=y(t.buttonRef))==null?void 0:p.id,id:r,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0,onMousedown:b},$=ze(o,["hold"]);return ce({ourProps:R,theirProps:$,slot:T,attrs:c,slots:t.virtual.value&&t.comboboxState.value===0?{...l,default:()=>[J(fl,{},l.default)]}:l,features:xe.RenderStrategy|xe.Static,visible:e.value,name:"ComboboxOptions"})}}}),Je=Q({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(o,{slots:c,attrs:l,expose:i}){let t=we("ComboboxOption"),r=`headlessui-combobox-option-${ae()}`,a=M(null),e=A(()=>o.disabled);i({el:a,$el:a});let b=A(()=>{var w;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(o.value):t.activeOptionIndex.value===null?!1:((w=t.options.value[t.activeOptionIndex.value])==null?void 0:w.id)===r}),v=A(()=>t.isSelected(o.value)),p=_e(ct,null),h=A(()=>({disabled:o.disabled,value:o.value,domRef:a,order:A(()=>o.order)}));ye(()=>t.registerOption(r,h)),Re(()=>t.unregisterOption(r,b.value)),me(()=>{let w=y(a);w&&(p==null||p.value.measureElement(w))}),me(()=>{t.comboboxState.value===0&&b.value&&(t.virtual.value||t.activationTrigger.value!==0&&pe(()=>{var w,I;return(I=(w=y(a))==null?void 0:w.scrollIntoView)==null?void 0:I.call(w,{block:"nearest"})}))});function T(w){w.preventDefault(),w.button===st.Left&&(e.value||(t.selectOption(r),Ht()||requestAnimationFrame(()=>{var I;return(I=y(t.inputRef))==null?void 0:I.focus({preventScroll:!0})}),t.mode.value===0&&t.closeCombobox()))}function R(){var w;if(o.disabled||(w=t.virtual.value)!=null&&w.disabled(o.value))return t.goToOption(q.Nothing);let I=t.calculateIndex(o.value);t.goToOption(q.Specific,I)}let $=qt();function D(w){$.update(w)}function V(w){var I;if(!$.wasMoved(w)||o.disabled||(I=t.virtual.value)!=null&&I.disabled(o.value)||b.value)return;let S=t.calculateIndex(o.value);t.goToOption(q.Specific,S,0)}function k(w){var I;$.wasMoved(w)&&(o.disabled||(I=t.virtual.value)!=null&&I.disabled(o.value)||b.value&&(t.optionsPropsRef.value.hold||t.goToOption(q.Nothing)))}return()=>{let{disabled:w}=o,I={active:b.value,selected:v.value,disabled:w},S={id:r,ref:a,role:"option",tabIndex:w===!0?void 0:-1,"aria-disabled":w===!0?!0:void 0,"aria-selected":v.value,disabled:void 0,onMousedown:T,onFocus:R,onPointerenter:D,onMouseenter:D,onPointermove:V,onMousemove:V,onPointerleave:k,onMouseleave:k},n=ze(o,["order","value"]);return ce({ourProps:S,theirProps:n,slot:I,attrs:l,slots:c,name:"ComboboxOption"})}}});var ml=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(ml||{});let pt=Symbol("PopoverContext");function Ne(o){let c=_e(pt,null);if(c===null){let l=new Error(`<${o} /> is missing a parent <${mt.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,Ne),l}return c}let hl=Symbol("PopoverGroupContext");function vt(){return _e(hl,null)}let ft=Symbol("PopoverPanelContext");function gl(){return _e(ft,null)}let mt=Q({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(o,{slots:c,attrs:l,expose:i}){var t;let r=M(null);i({el:r,$el:r});let a=M(1),e=M(null),b=M(null),v=M(null),p=M(null),h=A(()=>ke(r)),T=A(()=>{var n,g;if(!y(e)||!y(p))return!1;for(let F of document.querySelectorAll("body > *"))if(Number(F==null?void 0:F.contains(y(e)))^Number(F==null?void 0:F.contains(y(p))))return!0;let f=Be(),u=f.indexOf(y(e)),O=(u+f.length-1)%f.length,d=(u+1)%f.length,x=f[O],P=f[d];return!((n=y(p))!=null&&n.contains(x))&&!((g=y(p))!=null&&g.contains(P))}),R={popoverState:a,buttonId:M(null),panelId:M(null),panel:p,button:e,isPortalled:T,beforePanelSentinel:b,afterPanelSentinel:v,togglePopover(){a.value=Z(a.value,{0:1,1:0})},closePopover(){a.value!==1&&(a.value=1)},close(n){R.closePopover();let g=n?n instanceof HTMLElement?n:n.value instanceof HTMLElement?y(n):y(R.button):y(R.button);g==null||g.focus()}};Me(pt,R),ot(A(()=>Z(a.value,{0:de.Open,1:de.Closed})));let $={buttonId:R.buttonId,panelId:R.panelId,close(){R.closePopover()}},D=vt(),V=D==null?void 0:D.registerPopover,[k,w]=Pt(),I=At({mainTreeNodeRef:D==null?void 0:D.mainTreeNodeRef,portals:k,defaultContainers:[e,p]});function S(){var n,g,f,u;return(u=D==null?void 0:D.isFocusWithinPopoverGroup())!=null?u:((n=h.value)==null?void 0:n.activeElement)&&(((g=y(e))==null?void 0:g.contains(h.value.activeElement))||((f=y(p))==null?void 0:f.contains(h.value.activeElement)))}return me(()=>V==null?void 0:V($)),Ft((t=h.value)==null?void 0:t.defaultView,"focus",n=>{var g,f;n.target!==window&&n.target instanceof HTMLElement&&a.value===0&&(S()||e&&p&&(I.contains(n.target)||(g=y(R.beforePanelSentinel))!=null&&g.contains(n.target)||(f=y(R.afterPanelSentinel))!=null&&f.contains(n.target)||R.closePopover()))},!0),lt(I.resolveContainers,(n,g)=>{var f;R.closePopover(),Ut(g,Wt.Loose)||(n.preventDefault(),(f=y(e))==null||f.focus())},A(()=>a.value===0)),()=>{let n={open:a.value===0,close:R.close};return J(ue,[J(w,{},()=>ce({theirProps:{...o,...l},ourProps:{ref:r},slot:n,slots:c,attrs:l,name:"Popover"})),J(I.MainTreeNode)])}}}),bl=Q({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(o,{attrs:c,slots:l,expose:i}){var t;let r=(t=o.id)!=null?t:`headlessui-popover-button-${ae()}`,a=Ne("PopoverButton"),e=A(()=>ke(a.button));i({el:a.button,$el:a.button}),ye(()=>{a.buttonId.value=r}),Re(()=>{a.buttonId.value=null});let b=vt(),v=b==null?void 0:b.closeOthers,p=gl(),h=A(()=>p===null?!1:p.value===a.panelId.value),T=M(null),R=`headlessui-focus-sentinel-${ae()}`;h.value||me(()=>{a.button.value=y(T)});let $=at(A(()=>({as:o.as,type:c.type})),T);function D(n){var g,f,u,O,d;if(h.value){if(a.popoverState.value===1)return;switch(n.key){case K.Space:case K.Enter:n.preventDefault(),(f=(g=n.target).click)==null||f.call(g),a.closePopover(),(u=y(a.button))==null||u.focus();break}}else switch(n.key){case K.Space:case K.Enter:n.preventDefault(),n.stopPropagation(),a.popoverState.value===1&&(v==null||v(a.buttonId.value)),a.togglePopover();break;case K.Escape:if(a.popoverState.value!==0)return v==null?void 0:v(a.buttonId.value);if(!y(a.button)||(O=e.value)!=null&&O.activeElement&&!((d=y(a.button))!=null&&d.contains(e.value.activeElement)))return;n.preventDefault(),n.stopPropagation(),a.closePopover();break}}function V(n){h.value||n.key===K.Space&&n.preventDefault()}function k(n){var g,f;o.disabled||(h.value?(a.closePopover(),(g=y(a.button))==null||g.focus()):(n.preventDefault(),n.stopPropagation(),a.popoverState.value===1&&(v==null||v(a.buttonId.value)),a.togglePopover(),(f=y(a.button))==null||f.focus()))}function w(n){n.preventDefault(),n.stopPropagation()}let I=et();function S(){let n=y(a.panel);if(!n)return;function g(){Z(I.value,{[ie.Forwards]:()=>fe(n,re.First),[ie.Backwards]:()=>fe(n,re.Last)})===Ve.Error&&fe(Be().filter(f=>f.dataset.headlessuiFocusGuard!=="true"),Z(I.value,{[ie.Forwards]:re.Next,[ie.Backwards]:re.Previous}),{relativeTo:y(a.button)})}g()}return()=>{let n=a.popoverState.value===0,g={open:n},{...f}=o,u=h.value?{ref:T,type:$.value,onKeydown:D,onClick:k}:{ref:T,id:r,type:$.value,"aria-expanded":a.popoverState.value===0,"aria-controls":y(a.panel)?a.panelId.value:void 0,disabled:o.disabled?!0:void 0,onKeydown:D,onKeyup:V,onClick:k,onMousedown:w};return J(ue,[ce({ourProps:u,theirProps:{...c,...f},slot:g,attrs:c,slots:l,name:"PopoverButton"}),n&&!h.value&&a.isPortalled.value&&J(Ee,{id:R,features:Te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:S})])}}}),xl=Q({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(o,{attrs:c,slots:l,expose:i}){var t;let r=(t=o.id)!=null?t:`headlessui-popover-panel-${ae()}`,{focus:a}=o,e=Ne("PopoverPanel"),b=A(()=>ke(e.panel)),v=`headlessui-focus-sentinel-before-${ae()}`,p=`headlessui-focus-sentinel-after-${ae()}`;i({el:e.panel,$el:e.panel}),ye(()=>{e.panelId.value=r}),Re(()=>{e.panelId.value=null}),Me(ft,e.panelId),me(()=>{var w,I;if(!a||e.popoverState.value!==0||!e.panel)return;let S=(w=b.value)==null?void 0:w.activeElement;(I=y(e.panel))!=null&&I.contains(S)||fe(y(e.panel),re.First)});let h=tt(),T=A(()=>h!==null?(h.value&de.Open)===de.Open:e.popoverState.value===0);function R(w){var I,S;switch(w.key){case K.Escape:if(e.popoverState.value!==0||!y(e.panel)||b.value&&!((I=y(e.panel))!=null&&I.contains(b.value.activeElement)))return;w.preventDefault(),w.stopPropagation(),e.closePopover(),(S=y(e.button))==null||S.focus();break}}function $(w){var I,S,n,g,f;let u=w.relatedTarget;u&&y(e.panel)&&((I=y(e.panel))!=null&&I.contains(u)||(e.closePopover(),((n=(S=y(e.beforePanelSentinel))==null?void 0:S.contains)!=null&&n.call(S,u)||(f=(g=y(e.afterPanelSentinel))==null?void 0:g.contains)!=null&&f.call(g,u))&&u.focus({preventScroll:!0})))}let D=et();function V(){let w=y(e.panel);if(!w)return;function I(){Z(D.value,{[ie.Forwards]:()=>{var S;fe(w,re.First)===Ve.Error&&((S=y(e.afterPanelSentinel))==null||S.focus())},[ie.Backwards]:()=>{var S;(S=y(e.button))==null||S.focus({preventScroll:!0})}})}I()}function k(){let w=y(e.panel);if(!w)return;function I(){Z(D.value,{[ie.Forwards]:()=>{let S=y(e.button),n=y(e.panel);if(!S)return;let g=Be(),f=g.indexOf(S),u=g.slice(0,f+1),O=[...g.slice(f+1),...u];for(let d of O.slice())if(d.dataset.headlessuiFocusGuard==="true"||n!=null&&n.contains(d)){let x=O.indexOf(d);x!==-1&&O.splice(x,1)}fe(O,re.First,{sorted:!1})},[ie.Backwards]:()=>{var S;fe(w,re.Previous)===Ve.Error&&((S=y(e.button))==null||S.focus())}})}I()}return()=>{let w={open:e.popoverState.value===0,close:e.close},{focus:I,...S}=o,n={ref:e.panel,id:r,onKeydown:R,onFocusout:a&&e.popoverState.value===0?$:void 0,tabIndex:-1};return ce({ourProps:n,theirProps:{...c,...S},attrs:c,slot:w,slots:{...l,default:(...g)=>{var f;return[J(ue,[T.value&&e.isPortalled.value&&J(Ee,{id:v,ref:e.beforePanelSentinel,features:Te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:V}),(f=l.default)==null?void 0:f.call(l,...g),T.value&&e.isPortalled.value&&J(Ee,{id:p,ref:e.afterPanelSentinel,features:Te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k})])]}},features:xe.RenderStrategy|xe.Static,visible:T.value,name:"PopoverPanel"})}}});function Xe(o,c){return N(),j("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z","clip-rule":"evenodd"})])}function Qe(o,c){return N(),j("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"fill-rule":"evenodd",d:"M10.53 3.47a.75.75 0 0 0-1.06 0L6.22 6.72a.75.75 0 0 0 1.06 1.06L10 5.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-3.25-3.25Zm-4.31 9.81 3.25 3.25a.75.75 0 0 0 1.06 0l3.25-3.25a.75.75 0 1 0-1.06-1.06L10 14.94l-2.72-2.72a.75.75 0 0 0-1.06 1.06Z","clip-rule":"evenodd"})])}const yl={class:"fixed inset-0 overflow-y-auto"},wl={class:"flex min-h-full items-center justify-center p-4 text-center"},_l={class:"mt-4"},Sl={class:"text-sm text-gray-500 mb-4"},Ol={class:"mt-2"},Il=["accept"],Cl={key:0,class:"text-sm text-gray-500"},El={key:1,class:"text-sm text-emerald-600 font-medium"},Tl={key:0,class:"mt-2 text-red-500 text-sm"},Rl={key:1,class:"mt-4"},Ml={class:"flex items-center justify-between mb-1"},kl={class:"text-sm font-medium text-emerald-700"},$l={class:"w-full bg-gray-200 rounded-full h-2.5"},Pl={class:"text-xs text-gray-500 mt-1"},Al={key:2,class:"mt-4 p-3 bg-gray-50 rounded border border-gray-100"},Fl={class:"space-y-2 mb-4"},Dl={class:"flex justify-between text-sm"},Vl={class:"font-medium"},zl={class:"flex justify-between text-sm"},Bl={class:"font-medium text-emerald-600"},Nl={class:"flex justify-between text-sm"},jl={class:"font-medium text-red-600"},Ll={key:0,class:"pt-3"},Hl={class:"text-sm font-medium text-gray-600 capitalize mb-1"},Ul={class:"pl-0 space-y-1 text-xs"},Wl={class:"flex justify-between"},Kl={class:"font-medium"},ql={class:"flex justify-between"},Gl={class:"font-medium text-emerald-600"},Yl={class:"flex justify-between"},Zl={class:"font-medium text-yellow-600"},Jl={class:"flex justify-between"},Xl={class:"font-medium text-red-600"},Ql={key:0,class:"mt-2"},eo=["onClick"],to={key:0,class:"mt-1 max-h-32 overflow-y-auto"},lo={class:"font-medium"},oo={class:"text-red-700"},ao={key:0,class:"text-gray-600 mt-1"},no={key:1,class:"text-gray-600"},so={class:"mt-6 flex justify-between"},io=["disabled"],ro=Q({__name:"ImportDialog",props:{endpoint:{type:String,required:!0},title:{type:String,default:""},description:{type:String,default:"Upload an Excel or CSV file to import data. The system will process and import valid entries."},acceptedFileTypes:{type:String,default:".xlsx, .xls, .csv"},maxFileSize:{type:Number,default:5},successMessage:{type:String,default:"Successfully imported data from {fileName}"},fileFieldName:{type:String,default:"file"}},emits:["import-success"],setup(o,{emit:c}){const l=o,i=M(!1),t=M(null),r=M(null),a=M(""),e=M(!1),b=M(0),v=M(""),p=M(null),h=M({}),T=c;function R(){i.value=!0}function $(){i.value=!1,r.value=null,a.value="",b.value=0,v.value="",p.value=null,h.value={}}function D(S){h.value[S]=!h.value[S]}function V(){var S;(S=t.value)==null||S.click()}function k(S){var g;const n=S.target;if(n.files&&n.files.length>0){const f=n.files[0],u=l.acceptedFileTypes.split(",").map(d=>d.trim().toLowerCase()),O="."+((g=f.name.split(".").pop())==null?void 0:g.toLowerCase());if(!u.some(d=>d===O||d===f.type)){a.value=`Please select a valid file (${l.acceptedFileTypes})`,r.value=null;return}if(f.size>l.maxFileSize*1024*1024){a.value=`File size should be less than ${l.maxFileSize}MB`,r.value=null;return}a.value="",r.value=f}}function w(){T("import-success"),$()}async function I(){if(r.value){e.value=!0,b.value=0,v.value="Preparing to upload file...",p.value=null;try{const{$api:S,$toast:n}=Ae(),g=new FormData;g.append("file",r.value);const f=await S.postWithProgress(l.endpoint,g,(O,d)=>{b.value=O,v.value=d});if(f.summary){let O=0,d=0,x=0;const P={};Object.keys(f.summary).forEach(F=>{const z=f.summary[F];O+=z.total||0,d+=z.created||0,x+=z.failed||0,z.total>0&&(P[F]={total:z.total,created:z.created,skipped:z.skipped,failed:z.failed,errors:z.errors||[]})}),p.value={totalRecords:O,successful:d,failed:x,details:P}}else p.value={totalRecords:f.totalRecords||0,successful:f.successCount||0,failed:(f.totalRecords||0)-(f.successCount||0)};v.value="Import completed successfully!",b.value=100;const u=l.successMessage.replace("{fileName}",r.value.name);n.success(u)}catch(S){console.error("Error uploading file:",S);const{$toast:n}=Ae();v.value=`Error: ${S.message||"Failed to import data"}`,b.value=0,n.error(S.message||"Failed to import data. Please try again.")}finally{e.value=!1}}}return(S,n)=>{const g=Pe("Icon");return N(),j("div",null,[Et(S.$slots,"trigger",{},()=>[s("button",{onClick:R,class:"cursor-pointer bg-white border border-gray-200 transition duration-150 flex items-center px-2.5 py-2 rounded"},n[0]||(n[0]=[s("svg",{class:"w-5 h-5 mr-1",xmlns:"http://www.w3.org/2000/svg",width:"256",height:"256",viewBox:"0 0 256 256"},[s("g",{fill:"currentColor"},[s("path",{d:"M216 48v160H40V48a16 16 0 0 1 16-16h144a16 16 0 0 1 16 16",opacity:"0.2"}),s("path",{d:"M224 144v64a8 8 0 0 1-8 8H40a8 8 0 0 1-8-8v-64a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0M93.66 77.66L120 51.31V144a8 8 0 0 0 16 0V51.31l26.34 26.35a8 8 0 0 0 11.32-11.32l-40-40a8 8 0 0 0-11.32 0l-40 40a8 8 0 0 0 11.32 11.32"})])],-1),ve(" Import ")]))]),B(_(De),{appear:"",show:i.value,as:"template"},{default:L(()=>[B(_(Dt),{as:"div",onClose:$,class:"relative z-[9999]"},{default:L(()=>[B(_(He),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:L(()=>n[1]||(n[1]=[s("div",{class:"fixed inset-0 bg-black/25"},null,-1)])),_:1}),s("div",yl,[s("div",wl,[B(_(He),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:L(()=>[B(_(Vt),{class:"w-full max-w-lg transform overflow-hidden rounded bg-white p-6 text-left align-middle shadow-xl transition-all"},{default:L(()=>[B(_(zt),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:L(()=>[ve(U(o.title||"Import Data"),1)]),_:1}),s("div",_l,[s("p",Sl,U(o.description||"Upload an Excel file to import data. The system will process and import valid entries."),1),s("div",Ol,[s("input",{type:"file",ref_key:"fileInput",ref:t,onChange:k,accept:l.acceptedFileTypes,class:"hidden"},null,40,Il),s("div",{onClick:V,class:ee(["border-2 border-dashed border-gray-300 rounded py-8 px-4 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50",{"pointer-events-none":e.value}])},[n[2]||(n[2]=s("svg",{class:"w-auto h-20 mb-2",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},[s("defs",null,[s("linearGradient",{id:"vscodeIconsFileTypeExcel0",x1:"4.494",x2:"13.832",y1:"-2092.086",y2:"-2075.914",gradientTransform:"translate(0 2100)",gradientUnits:"userSpaceOnUse"},[s("stop",{offset:"0","stop-color":"#18884f"}),s("stop",{offset:".5","stop-color":"#117e43"}),s("stop",{offset:"1","stop-color":"#0b6631"})])]),s("path",{fill:"#185c37",d:"M19.581 15.35L8.512 13.4v14.409A1.19 1.19 0 0 0 9.705 29h19.1A1.19 1.19 0 0 0 30 27.809V22.5Z"}),s("path",{fill:"#21a366",d:"M19.581 3H9.705a1.19 1.19 0 0 0-1.193 1.191V9.5L19.581 16l5.861 1.95L30 16V9.5Z"}),s("path",{fill:"#107c41",d:"M8.512 9.5h11.069V16H8.512Z"}),s("path",{d:"M16.434 8.2H8.512v16.25h7.922a1.2 1.2 0 0 0 1.194-1.191V9.391A1.2 1.2 0 0 0 16.434 8.2",opacity:"0.1"}),s("path",{d:"M15.783 8.85H8.512V25.1h7.271a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191",opacity:"0.2"}),s("path",{d:"M15.783 8.85H8.512V23.8h7.271a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191",opacity:"0.2"}),s("path",{d:"M15.132 8.85h-6.62V23.8h6.62a1.2 1.2 0 0 0 1.194-1.191V10.041a1.2 1.2 0 0 0-1.194-1.191",opacity:"0.2"}),s("path",{fill:"url(#vscodeIconsFileTypeExcel0)",d:"M3.194 8.85h11.938a1.193 1.193 0 0 1 1.194 1.191v11.918a1.193 1.193 0 0 1-1.194 1.191H3.194A1.19 1.19 0 0 1 2 21.959V10.041A1.19 1.19 0 0 1 3.194 8.85"}),s("path",{fill:"#fff",d:"m5.7 19.873l2.511-3.884l-2.3-3.862h1.847L9.013 14.6c.116.234.2.408.238.524h.017q.123-.281.26-.546l1.342-2.447h1.7l-2.359 3.84l2.419 3.905h-1.809l-1.45-2.711A2.4 2.4 0 0 1 9.2 16.8h-.024a1.7 1.7 0 0 1-.168.351l-1.493 2.722Z"}),s("path",{fill:"#33c481",d:"M28.806 3h-9.225v6.5H30V4.191A1.19 1.19 0 0 0 28.806 3"}),s("path",{fill:"#107c41",d:"M19.581 16H30v6.5H19.581Z"})],-1)),r.value?(N(),j("p",El,U(r.value.name),1)):(N(),j("p",Cl," Click to select a file (Excel or CSV) "))],2),a.value?(N(),j("div",Tl,U(a.value),1)):W("",!0),e.value?(N(),j("div",Rl,[s("div",Ml,[n[3]||(n[3]=s("span",{class:"text-sm font-medium text-emerald-700"},"Uploading...",-1)),s("span",kl,U(b.value)+"%",1)]),s("div",$l,[s("div",{class:"bg-emerald-600 h-2.5 rounded-full transition-all duration-300",style:Tt({width:`${b.value}%`})},null,4)]),s("p",Pl,U(v.value),1)])):W("",!0),p.value?(N(),j("div",Al,[n[13]||(n[13]=s("h4",{class:"font-medium text-gray-800 mb-3"}," Import Summary ",-1)),s("div",Fl,[s("div",Dl,[n[4]||(n[4]=s("span",null,"Total Records:",-1)),s("span",Vl,U(p.value.totalRecords),1)]),s("div",zl,[n[5]||(n[5]=s("span",null,"Successfully Imported:",-1)),s("span",Bl,U(p.value.successful),1)]),s("div",Nl,[n[6]||(n[6]=s("span",null,"Failed Records:",-1)),s("span",jl,U(p.value.failed),1)])]),p.value.details?(N(),j("div",Ll,[n[12]||(n[12]=s("h5",{class:"text-sm font-medium text-gray-700 mb-2"}," Breakdown by Type: ",-1)),(N(!0),j(ue,null,Ce(p.value.details,(f,u)=>(N(),j("div",{key:u,class:"mb-3"},[s("div",Hl,U(String(u).replace("_"," "))+": ",1),s("div",Ul,[s("div",Wl,[n[7]||(n[7]=s("span",null,"Total:",-1)),s("span",Kl,U(f.total),1)]),s("div",ql,[n[8]||(n[8]=s("span",null,"Created:",-1)),s("span",Gl,U(f.created),1)]),s("div",Yl,[n[9]||(n[9]=s("span",null,"Skipped:",-1)),s("span",Zl,U(f.skipped),1)]),s("div",Jl,[n[10]||(n[10]=s("span",null,"Failed:",-1)),s("span",Xl,U(f.failed),1)]),f.errors&&f.errors.length>0?(N(),j("div",Ql,[s("button",{onClick:O=>D(String(u)),class:"text-xs text-red-600 flex items-center cursor-pointer hover:text-red-800 underline"},[n[11]||(n[11]=s("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},[s("path",{fill:"currentColor",d:"M10 2a8 8 0 1 1 0 16a8 8 0 0 1 0-16m0 1a7 7 0 1 0 0 14a7 7 0 0 0 0-14m0 9.5a.75.75 0 1 1 0 1.5a.75.75 0 0 1 0-1.5M10 6a.5.5 0 0 1 .492.41l.008.09V11a.5.5 0 0 1-.992.09L9.5 11V6.5A.5.5 0 0 1 10 6"})],-1)),ve(" "+U(h.value[String(u)]?"Hide":"Show")+" "+U(f.errors.length)+" error(s) ",1)],8,eo),h.value[String(u)]?(N(),j("div",to,[(N(!0),j(ue,null,Ce(f.errors,(O,d)=>(N(),j("div",{key:d,class:"text-xs text-red-600 bg-red-50 p-2 rounded mb-1 border border-red-100"},[s("div",lo," Row "+U(O.row)+": ",1),s("div",oo,U(O.error),1),O.test_type?(N(),j("div",ao," Test Type: "+U(O.test_type),1)):W("",!0),O.measure_name?(N(),j("div",no," Measure: "+U(O.measure_name),1)):W("",!0)]))),128))])):W("",!0)])):W("",!0)])]))),128))])):W("",!0)])):W("",!0)])]),s("div",so,[s("button",{type:"button",class:"inline-flex justify-center rounded border border-transparent bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300 focus:outline-none",onClick:$}," Cancel "),p.value?W("",!0):(N(),j("button",{key:0,type:"button",disabled:!r.value||e.value,class:ee(["inline-flex justify-center cursor-pointer rounded border border-transparent px-4 py-2 text-sm font-medium text-white focus:outline-none",!r.value||e.value?"bg-emerald-300 cursor-not-allowed":"bg-emerald-600 hover:bg-emerald-700"]),onClick:I},[e.value?(N(),Ie(g,{key:0,icon:"svg-spinners:180-ring",class:"w-5 h-5 mr-2"})):W("",!0),ve(" "+U(e.value?"Importing...":"Import"),1)],10,io)),p.value?(N(),j("button",{key:1,type:"button",class:"inline-flex justify-center cursor-pointer rounded border border-transparent bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-700 focus:outline-none",onClick:w},[B(g,{icon:"mdi:check-circle",class:"w-5 h-5 mr-2"}),n[14]||(n[14]=ve(" Complete "))])):W("",!0)])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),uo={class:"px-4 py-8"},co={class:"w-full flex flex-col sm:flex-row items-start sm:items-center justify-between bg-white border border-gray-100 rounded my-2 px-2 py-2"},po={class:"w-full flex flex-col lg:flex-row items-start lg:items-center lg:space-x-6 space-y-3 lg:space-y-0"},vo={class:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3"},fo={class:"w-full sm:w-64"},mo={class:"relative mt-1 z-50"},ho={class:"relative w-full cursor-default overflow-hidden rounded bg-gray-50 text-leftfocus:outline-none focus-visible:ring-2 focus-visible:ring-white/75 focus-visible:ring-offset-2 focus-visible:ring-offset-emerald-300"},go={key:0,class:"relative cursor-default select-none px-4 py-2 text-gray-700"},bo={class:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3"},xo={class:"w-full sm:w-64"},yo={class:"relative mt-1 z-50"},wo={class:"relative w-full cursor-default overflow-hidden rounded bg-gray-50 text-leftfocus:outline-none focus-visible:ring-2 focus-visible:ring-white/75 focus-visible:ring-offset-2 focus-visible:ring-offset-emerald-300"},_o={key:0,class:"relative cursor-default select-none px-4 py-2 text-gray-700"},So={class:"py-2 sm:py-0"},Oo={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-emerald-500 rounded-full border-2 border-white"},Io={class:"p-4 space-y-4"},Co={class:"space-y-2"},Eo={class:"space-y-2"},To={class:"space-y-2"},Ro={class:"space-y-2"},Mo={class:"w-full flex flex-col md:flex-row items-start md:items-center justify-between gap-4 my-4"},ko={class:"flex items-center space-x-4 w-full md:w-auto"},$o={class:"mt-5"},Po={class:"font-medium text-lg"},Ao=["innerHTML"],Fo={class:"flex items-center space-x-2"},Do=["onClick"],Vo=["onClick"],zo={class:"cursor-pointer"},be="YYYY-MM-DD",Bo=Q({__name:"index",setup(o){Bt({title:"Test Types | Malawi Test Catalog"});const{$api:c,$toast:l,$metadata:i}=Ae(),{canEdit:t}=Nt(),r=M(""),a=M(!1),e=M([]),b=M(0),v=M({page:1,rowsPerPage:25,sortBy:"",sortType:"asc"}),p=[{text:"NAME",value:"name",sortable:!0},{text:"SHORT NAME",value:"short_name",sortable:!0},{text:"OTHER NAMES",value:"preferred_name",sortable:!0},{text:"NLIMS CODE",value:"nlims_code",sortable:!0},{text:"DESCRIPTION",value:"description",sortable:!1},{text:"DATE CREATED",value:"created_at",sortable:!0},{text:"ACTIONS",value:"actions",sortable:!1}],h=M([]),T=M([]),R=M([]),$=M();let D=M(T.value[0]),V=M("");const k=M({sex:"",target_tat:"",has_nlims_code:"",has_loinc_code:""}),w=A(()=>Object.values(k.value).some(C=>C!=="")),I=A(()=>T.value.filter(C=>C.name.toLowerCase().includes(V.value.toLowerCase()))),S=()=>{const C={page:v.value.page,per_page:v.value.rowsPerPage};return r.value&&(C.search=r.value),$.value&&$.value.id!==0&&(C.test_category_id=$.value.id),D.value&&D.value.id!==0&&(C.specimen_type_id=D.value.id),k.value.sex&&(C.sex=k.value.sex),k.value.target_tat&&(C.target_tat=k.value.target_tat),k.value.has_nlims_code&&(C.has_nlims_code=k.value.has_nlims_code),k.value.has_loinc_code&&(C.has_loinc_code=k.value.has_loinc_code),v.value.sortBy&&(C.sort_by=v.value.sortBy,C.sort_order=v.value.sortType),C},n=A(()=>({name:`malawi-test-catalog-test-types-${he().format(be)}`,headers:["Malawi Test Catalog Test Types","Report Date: "+he().format(be)],data:g.value.map(C=>({NAME:C.name,"SHORT NAME":C.short_name,"PREFERRED NAME":C.preferred_name,DESCRIPTION:C.description,"TARGET TURN AROUND TIME":C.targetTAT,"MOH CODE":C.moh_code,"NLIMS CODE":C.nlims_code,"LONIC CODE":C.loinc_code,"CAN BE DONE ON SEX":C.can_be_done_on_sex,"DATE CREATED":he(C.created_at).format(be)}))})),g=M([]),f=async()=>{const C={...S(),no_paginate:!0};delete C.page,delete C.per_page;try{const m=await c.get("test_types",{params:C});g.value=m.map(G=>({...G,created_at:he(G.created_at).format(be)}))}catch(m){console.error("error occurred while fetching export data: ",m),l.error("An error occurred while preparing export data")}},u=async()=>{a.value=!0;const C=S();try{const m=await c.get("test_types",{params:C});Array.isArray(m)?(h.value=m.map(G=>({...G,created_at:he(G.created_at).format(be)})),b.value=m.length):(h.value=m.data.map(G=>({...G,created_at:he(G.created_at).format(be)})),b.value=m.pagination.total_count)}catch(m){console.error("error occurred: ",m),l.error("An error occurred while fetching test types")}finally{a.value=!1}},O=()=>{l.success("Test type deleted successfully"),u()},d=()=>{v.value.page=1,u(),f()},x=()=>{k.value={sex:"",target_tat:"",has_nlims_code:"",has_loinc_code:""},v.value.page=1,u(),f()},P=()=>{$.value=R.value[0],D.value=T.value[0],r.value="",x()},F=C=>{Y.push({path:"/app/test-types/view",query:{id:C.toString()}})};X(v,()=>{u()},{deep:!0});const z=M("");let H;X(r,C=>{clearTimeout(H),H=setTimeout(()=>{z.value=C,v.value.page=1,u()},500)}),X([$,D],()=>{v.value.page=1,u()}),X([$,D,r,k],()=>{f()},{deep:!0});const Y=Rt();Mt(()=>{u()});const ne=async()=>{const C=await i.departments.getAll();R.value=C,R.value.unshift({id:0,name:"All",description:"",created_at:"",updated_at:"",moh_code:null,nlims_code:null,loinc_code:null,preferred_name:null,scientific_name:null,short_name:null}),$.value=R.value[0]};return ye(async()=>{a.value=!0,h.value=[],await u(),f(),await ne();const C=await i.specimen_types.getAll();T.value=C,T.value.unshift({id:0,name:"All",description:"",created_at:"",updated_at:"",moh_code:null,nlims_code:null,loinc_code:null,preferred_name:null,scientific_name:null,iblis_mapping_name:null}),D.value=T.value[0]}),(C,m)=>{const G=Pe("Icon"),ht=yt,gt=wt,bt=_t,xt=Pe("datatable");return N(),j("div",uo,[m[28]||(m[28]=s("div",null,[s("h1",{class:"text-3xl font-semibold py-4"},"Test Types ")],-1)),s("div",co,[s("div",po,[s("div",vo,[m[14]||(m[14]=s("p",{class:"whitespace-nowrap"},[s("span",{class:"text-lg font-medium"},"Test category:")],-1)),s("div",fo,[B(_(qe),{modelValue:_($),"onUpdate:modelValue":m[2]||(m[2]=E=>oe($)?$.value=E:null)},{default:L(()=>[s("div",mo,[s("div",ho,[B(_(Ye),{class:"w-full border-none py-2 pl-3 leading-5 text-gray-900 focus:ring-0",displayValue:E=>E.name,onChange:m[0]||(m[0]=E=>oe(V)?V.value=E.target.value:V=E.target.value)},null,8,["displayValue"]),B(_(Ge),{class:"absolute inset-y-0 right-0 flex items-center pr-2"},{default:L(()=>[B(_(Qe),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1})]),B(_(De),{leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",onAfterLeave:m[1]||(m[1]=E=>oe(V)?V.value="":V="")},{default:L(()=>[B(_(Ze),{class:"absolute mt-1 max-h-60 w-full overflow-auto rounded bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none"},{default:L(()=>[_(R).length===0&&_(V)!==""?(N(),j("div",go," Nothing found. ")):W("",!0),(N(!0),j(ue,null,Ce(_(R),E=>(N(),Ie(_(Je),{as:"template",key:E.id,value:E},{default:L(({selected:te,active:le})=>[s("li",{class:ee(["relative cursor-default select-none py-2 pl-10 pr-4",{"bg-emerald-600 text-white":le,"text-gray-900":!le}])},[s("span",{class:ee(["block truncate",{"font-medium":te,"font-normal":!te}])},U(E.name),3),te?(N(),j("span",{key:0,class:ee(["absolute inset-y-0 left-0 flex items-center pl-3",{"text-white":le,"text-emerald-600":!le}])},[B(_(Xe),{class:"h-5 w-5","aria-hidden":"true"})],2)):W("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])])]),s("div",bo,[m[15]||(m[15]=s("p",{class:"whitespace-nowrap"},[s("span",{class:"text-lg font-medium"},"Specimen:")],-1)),s("div",xo,[B(_(qe),{modelValue:_(D),"onUpdate:modelValue":m[5]||(m[5]=E=>oe(D)?D.value=E:D=E)},{default:L(()=>[s("div",yo,[s("div",wo,[B(_(Ye),{class:"w-full border-none py-2 pl-3 pr-10 leading-5 text-gray-900 focus:ring-0",displayValue:E=>E.name,onChange:m[3]||(m[3]=E=>oe(V)?V.value=E.target.value:V=E.target.value)},null,8,["displayValue"]),B(_(Ge),{class:"absolute inset-y-0 right-0 flex items-center pr-2"},{default:L(()=>[B(_(Qe),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1})]),B(_(De),{leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",onAfterLeave:m[4]||(m[4]=E=>oe(V)?V.value="":V="")},{default:L(()=>[B(_(Ze),{class:"absolute mt-1 max-h-60 w-full overflow-auto rounded bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none"},{default:L(()=>[_(I).length===0&&_(V)!==""?(N(),j("div",_o," Nothing found. ")):W("",!0),(N(!0),j(ue,null,Ce(_(I),E=>(N(),Ie(_(Je),{as:"template",key:E.id,value:E},{default:L(({selected:te,active:le})=>[s("li",{class:ee(["relative cursor-default select-none py-2 pl-10 pr-4",{"bg-emerald-600 text-white":le,"text-gray-900":!le}])},[s("span",{class:ee(["block truncate",{"font-medium":te,"font-normal":!te}])},U(E.name),3),te?(N(),j("span",{key:0,class:ee(["absolute inset-y-0 left-0 flex items-center pl-3",{"text-white":le,"text-emerald-600":!le}])},[B(_(Xe),{class:"h-5 w-5","aria-hidden":"true"})],2)):W("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])])])]),s("div",So,[B(_(mt),{class:"relative"},{default:L(()=>[B(_(bl),{class:ee(["bg-gray-100 cursor-pointer hover:bg-emerald-100 hover:text-emerald-600 hover:font-medium transition duration-150 rounded-full flex items-center px-2 py-1.5 my-2 w-full sm:w-auto justify-center sm:justify-start outline-none relative",{"bg-emerald-100 text-emerald-600 font-medium":_(w)}])},{default:L(()=>[s("div",{class:ee(["w-6 h-6 flex items-center self-center mr-2 rounded-full justify-center bg-emerald-700 text-emerald-100",{"bg-emerald-600":_(w)}])},[B(G,{icon:"fluent-mdl2:filters",class:"w-4 h-4"})],2),m[16]||(m[16]=ve(" Filters ")),_(w)?(N(),j("div",Oo)):W("",!0)]),_:1},8,["class"]),B(kt,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:L(()=>[B(_(xl),{class:"absolute right-0 top-full mt-2 w-80 bg-white rounded shadow-lg ring-1 ring-gray-200 ring-opacity-5 z-50"},{default:L(()=>[s("div",Io,[s("div",{class:"flex items-center justify-between"},[m[17]||(m[17]=s("h3",{class:"text-lg font-medium text-gray-900"},"Advanced Filters",-1)),s("button",{onClick:P,class:"text-sm text-gray-500 cursor-pointer hover:text-gray-700"}," Clear all ")]),s("div",Co,[m[19]||(m[19]=s("label",{class:"block text-sm font-medium text-gray-700"},"Gender",-1)),Se(s("select",{"onUpdate:modelValue":m[6]||(m[6]=E=>_(k).sex=E),class:"w-full border border-gray-300 rounded px-3 py-2 bg-white focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"},m[18]||(m[18]=[s("option",{value:""},"All",-1),s("option",{value:"Male"},"Male",-1),s("option",{value:"Female"},"Female",-1),s("option",{value:"Both"},"Both",-1)]),512),[[Oe,_(k).sex]])]),s("div",Eo,[m[21]||(m[21]=s("label",{class:"block text-sm font-medium text-gray-700"},"Target TAT",-1)),Se(s("select",{"onUpdate:modelValue":m[7]||(m[7]=E=>_(k).target_tat=E),class:"w-full border border-gray-300 rounded px-3 py-2 bg-white focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"},m[20]||(m[20]=[s("option",{value:""},"All",-1),s("option",{value:"30 Minutes"},"30 Minutes",-1),s("option",{value:"1 hour"},"1 Hour",-1),s("option",{value:"2 Hours"},"2 Hours",-1),s("option",{value:"24 Hours"},"24 Hours",-1),s("option",{value:"7 Days"},"7 Days",-1)]),512),[[Oe,_(k).target_tat]])]),s("div",To,[m[23]||(m[23]=s("label",{class:"block text-sm font-medium text-gray-700"},"Has NLIMS Code",-1)),Se(s("select",{"onUpdate:modelValue":m[8]||(m[8]=E=>_(k).has_nlims_code=E),class:"w-full border border-gray-300 rounded px-3 py-2 bg-white focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"},m[22]||(m[22]=[s("option",{value:""},"All",-1),s("option",{value:"true"},"Yes",-1),s("option",{value:"false"},"No",-1)]),512),[[Oe,_(k).has_nlims_code]])]),s("div",Ro,[m[25]||(m[25]=s("label",{class:"block text-sm font-medium text-gray-700"},"Has LOINC Code",-1)),Se(s("select",{"onUpdate:modelValue":m[9]||(m[9]=E=>_(k).has_loinc_code=E),class:"w-full border border-gray-300 rounded px-3 py-2 bg-white focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500"},m[24]||(m[24]=[s("option",{value:""},"All",-1),s("option",{value:"true"},"Yes",-1),s("option",{value:"false"},"No",-1)]),512),[[Oe,_(k).has_loinc_code]])]),s("div",{class:"flex items-center gap-2 pt-4"},[s("button",{onClick:d,class:"flex-1 cursor-pointer bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded transition duration-150 font-medium"}," Apply Filters "),s("button",{onClick:x,class:"px-4 cursor-pointer py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 transition duration-150"}," Reset ")])])]),_:1})]),_:1})]),_:1})])]),s("div",Mo,[s("div",ko,[_(t)?(N(),j("button",{key:0,onClick:m[10]||(m[10]=E=>C.$router.push("/app/test-types/create")),class:"cursor-pointer bg-emerald-600 hover:bg-emerald-700 transition duration-150 flex items-center text-emerald-100 px-2.5 py-2 rounded w-full md:w-auto"},[B(G,{icon:"mdi:plus",class:"w-5 h-5 mr-1"}),m[26]||(m[26]=ve(" Add new "))])):W("",!0),B(ht,{"export-data":_(n)},null,8,["export-data"]),B(ro,{endpoint:"test_types/import",title:"Import Test Types",description:"Upload an Excel file containing test type data. The system will process and import valid entries.","success-message":"Successfully imported test types from {fileName}",onImportSuccess:u})]),B(gt,{modelValue:_(r),"onUpdate:modelValue":m[11]||(m[11]=E=>oe(r)?r.value=E:null),placeholder:"Search test types",class:"w-full md:w-auto"},null,8,["modelValue"])]),s("div",$o,[B(xt,{"table-class-name":"datatable",headers:p,items:_(h),"items-selected":_(e),"onUpdate:itemsSelected":m[12]||(m[12]=E=>oe(e)?e.value=E:null),"server-options":_(v),"onUpdate:serverOptions":m[13]||(m[13]=E=>oe(v)?v.value=E:null),"server-items-length":_(b),alternating:"",loading:_(a),"server-side":""},{loading:L(()=>m[27]||(m[27]=[s("svg",{class:"w-15 h-15 text-emerald-600",width:"38",height:"38",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"oklch(0.596 0.145 163.225)"},[s("g",{fill:"none","fill-rule":"evenodd"},[s("g",{transform:"translate(1 1)","stroke-width":"2"},[s("circle",{"stroke-opacity":".5",cx:"18",cy:"18",r:"18"}),s("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[s("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})])])])],-1)])),"item-name":L(E=>[s("p",Po,U(E.name),1)]),"item-description":L(E=>[s("div",{class:"line-clamp-2",innerHTML:E.description},null,8,Ao)]),"item-actions":L(E=>[s("div",Fo,[s("button",{onClick:te=>F(E.id),class:"cursor-pointer"},[B(G,{icon:"lets-icons:view-alt-duotone",class:"w-5 h-5 mr-1"})],8,Do),_(t)?(N(),j("button",{key:0,onClick:te=>C.$router.push(`/app/test-types/update?id=${E.id}`),class:"cursor-pointer"},[B(G,{icon:"fa:edit",class:"w-5 h-5 mr-1"})],8,Vo)):W("",!0),_(t)?(N(),Ie(bt,{key:1,property:{id:E.id,name:"test type",endpoint:"test_types"},onConfirm:O},{default:L(()=>[s("button",zo,[B(G,{icon:"mdi:delete",class:"w-5 h-5 mr-1"})])]),_:2},1032,["property"])):W("",!0)])]),_:1},8,["items","items-selected","server-options","server-items-length","loading"])])])}}}),Qo=$t(Bo,[["__scopeId","data-v-80909b86"]]);export{Qo as default};
