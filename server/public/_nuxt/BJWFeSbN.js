import{_ as B}from"./eA2H0pyo.js";import{_ as N}from"./WCtLych_.js";import{_ as U}from"./Cy6ejAbI.js";import{_ as C}from"./Bf0aH3QM.js";import{_ as E}from"./BgOZ5tY3.js";import{d as I,u as T,x as $,y as M,r as _,z as O,o as D,k as R,c as A,b as F,e as i,f as r,g as H,l as s}from"./DSPXqrpM.js";import"./f4feb2ck.js";const P={class:"min-h-screen bg-gray-50 p-5"},k={class:"mx-auto"},L={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},S={class:"w-full py-5 px-5"},j={class:"w-full grid grid-cols-2 gap-5"},z={class:"overflow-hidden"},oe=I({__name:"[id]",setup(G){const{$metadata:c,$toast:u}=T(),v=$(),m=M(),d=_(!1),l=_(null),f=_([]),o=O({name:"",description:"",loinc_code:"",moh_code:"",nlims_code:"",id:0,created_at:"",updated_at:"",products:[]}),b={fields:[{name:"name",label:"Name",rules:{required:!0}},{name:"loinc_code",label:"LONIC code",rules:{required:!1}},{name:"moh_code",label:"MOH code",rules:{required:!1}},{name:"products",label:"Products",rules:{required:!0}}]},h=async()=>{const a=v.params.id;if(!a){u.error("Invalid equipment ID"),setTimeout(()=>{m.push("/app/equipments")},3e3);return}d.value=!0;try{const e=await c.equipments.getById(Number(a));l.value={...e,products:e.products.map(t=>t.id)},l.value!==null&&Object.keys(o).forEach(t=>{l.value&&t in l.value&&l.value[t]!==void 0&&(o[t]=l.value[t])})}catch{u.error("Failed to fetch equipment data"),setTimeout(()=>{m.push("/app/equipments")},3e3)}finally{d.value=!1}},q=async()=>{try{const a=await c.products.getAll();a&&(f.value=a)}catch(a){console.error(a)}};D(()=>{q(),h()});const g=async(a,e)=>{if(!(!e||!l.value)){d.value=!0;try{const t={...l.value,...o};await c.equipments.update(t.id,t),u.success("Equipment updated successfully"),setTimeout(()=>{m.push("/app/equipments")},2e3)}catch{u.error("An error occurred while updating equipment")}finally{d.value=!1}}};return(a,e)=>{const t=B,p=N,y=R("RichTextEditor"),V=U,w=C,x=E;return F(),A("div",P,[i("div",k,[i("div",L,[r(t,{mode:"primary",icon:"healthicons:medicines-outline",title:"Update equipment",description:"Modify details of the equipment"}),i("div",S,[r(x,{config:b,onSubmit:g},{default:H(({form:J})=>[i("div",j,[r(p,{name:"name",label:"Name",modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=n=>s(o).name=n),required:""},null,8,["modelValue"]),r(p,{name:"loinc_code",label:"LONIC code",modelValue:s(o).loinc_code,"onUpdate:modelValue":e[1]||(e[1]=n=>s(o).loinc_code=n)},null,8,["modelValue"]),r(p,{name:"moh_code",label:"MOH code",modelValue:s(o).moh_code,"onUpdate:modelValue":e[2]||(e[2]=n=>s(o).moh_code=n)},null,8,["modelValue"]),i("div",null,[e[5]||(e[5]=i("label",{for:"description",class:"block font-medium text-gray-700 mb-2"},"Description",-1)),i("div",z,[r(y,{theme:"snow",class:"editor",content:s(o).description,"onUpdate:content":e[3]||(e[3]=n=>s(o).description=n),contentType:"html"},null,8,["content"])])]),r(V,{name:"products",label:"Products",options:s(f).map(n=>({id:n.id,label:n.name})),modelValue:s(o).products,"onUpdate:modelValue":e[4]||(e[4]=n=>s(o).products=n),isMultiple:!0,required:""},null,8,["options","modelValue"])]),r(w,{class:"mt-4",label:"Update",loading:s(d),type:"submit"},null,8,["loading"])]),_:1})])])])])}}});export{oe as default};
