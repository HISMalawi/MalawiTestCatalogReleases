import{_ as j}from"./WCtLych_.js";import{d as B,k as q,c,b as f,e as r,f as g,i as F,q as S,t as E,r as C,u as _,p as $,w as T,o as A,F as k,A as U,H as D,I as L,C as O,J as R,l as N,K as J}from"./DSPXqrpM.js";import{_ as H}from"./Bcsf2iPY.js";import{E as Z}from"./il7jLVcv.js";import{u as z}from"./f4feb2ck.js";const K={class:"mb-8"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},G={class:"col-span-2"},Q={class:"overflow-hidden"},W={key:0,class:"text-red-500 text-sm mt-1"},pe=B({__name:"BasicInformation",props:{testPanel:{required:!0,type:Object},errors:{required:!0,type:Object}},setup(t){const y=t,m=v=>{const e=v||"";y.testPanel.description=e,console.log("Description updated:",y.testPanel.description);const o=new CustomEvent("description-updated",{detail:{description:e}});window.dispatchEvent(o)};return(v,e)=>{var a,p,V,P,x,i,s,h;const o=j,b=q("RichTextEditor");return f(),c("div",null,[r("div",K,[e[9]||(e[9]=r("div",{class:"bg-gray-50 border-b border-gray-100 px-2 py-2 rounded mb-3"},[r("h2",{class:"text-xl font-semibold"},"Basic Information")],-1)),r("div",Y,[g(o,{label:"Name",name:"name",modelValue:t.testPanel.name,"onUpdate:modelValue":e[0]||(e[0]=d=>t.testPanel.name=d),"error-message":(a=t.errors.name)==null?void 0:a.message,required:""},null,8,["modelValue","error-message"]),g(o,{label:"Short Name",name:"short_name",modelValue:t.testPanel.short_name,"onUpdate:modelValue":e[1]||(e[1]=d=>t.testPanel.short_name=d),"error-message":(p=t.errors.short_name)==null?void 0:p.message,required:""},null,8,["modelValue","error-message"]),g(o,{label:"Preferred Name",name:"preferred_name",modelValue:t.testPanel.preferred_name,"onUpdate:modelValue":e[2]||(e[2]=d=>t.testPanel.preferred_name=d),"error-message":(V=t.errors.preferred_name)==null?void 0:V.message},null,8,["modelValue","error-message"]),g(o,{label:"Scientific Name",name:"scientific_name",modelValue:t.testPanel.scientific_name,"onUpdate:modelValue":e[3]||(e[3]=d=>t.testPanel.scientific_name=d),"error-message":(P=t.errors.scientific_name)==null?void 0:P.message},null,8,["modelValue","error-message"]),g(o,{label:"LOINC Code",name:"loinc_code",modelValue:t.testPanel.loinc_code,"onUpdate:modelValue":e[4]||(e[4]=d=>t.testPanel.loinc_code=d),"error-message":(x=t.errors.loinc_code)==null?void 0:x.message,"icon-start":"bi:qr-code"},null,8,["modelValue","error-message"]),g(o,{label:"NLIMS Code",name:"nlims_code",modelValue:t.testPanel.nlims_code,"onUpdate:modelValue":e[5]||(e[5]=d=>t.testPanel.nlims_code=d),"error-message":(i=t.errors.nlims_code)==null?void 0:i.message,"icon-start":"bi:qr-code"},null,8,["modelValue","error-message"]),g(o,{label:"MOH Code",name:"moh_code",modelValue:t.testPanel.moh_code,"onUpdate:modelValue":e[6]||(e[6]=d=>t.testPanel.moh_code=d),"error-message":(s=t.errors.moh_code)==null?void 0:s.message,"icon-start":"bi:qr-code"},null,8,["modelValue","error-message"]),r("div",G,[e[8]||(e[8]=r("label",{for:"description",class:"block text-base font-medium text-gray-700 mb-1"},[F(" Description "),r("span",{class:"text-red-500"},"*")],-1)),r("div",Q,[g(b,{theme:"snow",class:"editor",content:y.testPanel.description,"onUpdate:content":[e[7]||(e[7]=d=>y.testPanel.description=d),m],contentType:"html"},null,8,["content"]),(h=t.errors.description)!=null&&h.message?(f(),c("div",W,E(t.errors.description.message),1)):S("",!0)])])])])])}}}),X={class:"mb-8"},ee={class:"w-full grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 mt-5"},te=["id","value"],se=["for"],ae={key:0,class:"w-full col-span-5 flex flex-col space-y-3 items-center justify-center py-10"},oe={key:0,class:"flex justify-center items-center mt-4 space-x-2"},le=["disabled"],re={class:"flex items-center space-x-1"},ne=["onClick"],ie={key:1,class:"px-1"},de=["disabled"],be=B({__name:"TestTypes",props:{errorMessage:{type:String,default:""},testPanel:{type:Object,required:!0,default:()=>({test_types:[]})}},emits:["update:selectedTestTypes"],setup(t,{emit:y}){const m=t,v=y,e=C(""),o=C([]),b=C([]),a=C(1),p=C(20),{$toast:V,$api:P}=_(),x=$(()=>b.value?b.value.filter(u=>u.name.toLowerCase().includes(e.value.toLowerCase())):[]),i=$(()=>{const u=(a.value-1)*p.value,n=u+p.value;return x.value.slice(u,n)}),s=$(()=>Math.ceil(x.value.length/p.value)),h=()=>{const u=o.value||[];v("update:selectedTestTypes",u)};T(e,()=>{a.value=1});let d=!1;T(()=>{var u;return(u=m.testPanel)==null?void 0:u.test_types},u=>{if(!d){if(d=!0,Array.isArray(u)){const n=o.value||[],w=[...u];JSON.stringify(n.sort())!==JSON.stringify(w.sort())&&(o.value=w)}else o.value=[];d=!1}},{immediate:!0,deep:!0});const M=async()=>{try{const u=await P.get(`${Z.TEST_TYPES}?no_paginate=true`);u&&(b.value=u)}catch{V.error("Failed to load test types. Please try again.")}};return A(M),(u,n)=>{const w=H;return f(),c("div",null,[r("div",X,[n[7]||(n[7]=r("div",{class:"bg-gray-50 border-b border-gray-100 px-2 py-2 rounded mb-3"},[r("h2",{class:"text-xl font-semibold"},"Test Types")],-1)),g(w,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=l=>e.value=l),clearable:"",placeholder:"Search test types..."},null,8,["modelValue"]),r("div",ee,[(f(!0),c(k,null,U(i.value,l=>(f(),c("div",{key:l.id,class:"flex items-center"},[D(r("input",{id:`test-type-${l.id}`,type:"checkbox",value:l.id,"onUpdate:modelValue":n[1]||(n[1]=I=>o.value=I),class:"h-4 w-4 rounded cursor-pointer border-gray-300 text-emerald-600 focus:ring-emerald-500",onChange:n[2]||(n[2]=()=>h())},null,40,te),[[L,o.value]]),r("label",{for:`test-type-${l.id}`,class:"ml-2 block text-gray-700 cursor-pointer"},E(l.name),9,se)]))),128)),x.value.length===0&&e.value?(f(),c("div",ae,[n[5]||(n[5]=r("svg",{class:"w-auto h-20 text-black",xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 512 512"},[r("path",{fill:"currentColor",d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3ZM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8a124.95 124.95 0 0 1-124.8-124.8Z"})],-1)),n[6]||(n[6]=r("p",{class:"text-gray-500 text-lg"},"No test types found",-1)),r("button",{type:"button",onClick:M,class:"text-sky-500 hover:text-sky-600 transition duration-150"},"Refresh")])):S("",!0)]),s.value>1?(f(),c("div",oe,[r("button",{type:"button",onClick:n[3]||(n[3]=l=>a.value=Math.max(1,a.value-1)),disabled:a.value===1,class:O(["px-3 py-1 cursor-pointer rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-100":a.value===1}])}," Previous ",10,le),r("div",re,[(f(!0),c(k,null,U(s.value,l=>(f(),c(k,{key:l},[l===a.value||l===1||l===s.value||l>=a.value-1&&l<=a.value+1?(f(),c("button",{key:0,type:"button",onClick:I=>a.value=l,class:O(["px-3 py-1 cursor-pointer rounded border border-gray-300",{"bg-emerald-600 text-white":l===a.value}])},E(l),11,ne)):l===a.value-2||l===a.value+2?(f(),c("span",ie,"...")):S("",!0)],64))),128))]),r("button",{type:"button",onClick:n[4]||(n[4]=l=>a.value=Math.min(s.value,a.value+1)),disabled:a.value===s.value,class:O(["px-3 py-1 cursor-pointer rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",{"bg-gray-100":a.value===s.value}])}," Next ",10,de)])):S("",!0)])])}}}),ge=B({__name:"CoreForm",props:{config:{},initialValues:{},validateOnSubmit:{type:Boolean,default:!0},validateOnChange:{type:Boolean,default:!1},validateOnMount:{type:Boolean,default:!1},modelValue:{}},emits:["submit","validation","reset","update:modelValue"],setup(t,{emit:y}){const m=t,v=y,{formValues:e,formErrors:o,isValid:b,validateField:a,validateAll:p,resetForm:V}=z(m.config);m.initialValues&&Object.entries(m.initialValues).forEach(([i,s])=>{i in e&&(e[i]=s)}),m.modelValue&&Object.entries(m.modelValue).forEach(([i,s])=>{i in e&&(e[i]=s)}),T(e,i=>{m.modelValue&&v("update:modelValue",{...i}),m.validateOnChange&&p()},{deep:!0}),T(()=>m.modelValue,i=>{i&&Object.entries(i).forEach(([s,h])=>{s in e&&e[s]!==h&&(e[s]=h)})},{deep:!0}),J("formContext",{formValues:e,formErrors:o,isValid:b,validateField:a,validateAll:p,resetForm:V});const P=i=>{if(i.preventDefault(),m.modelValue&&Object.keys(e).forEach(s=>{s in m.modelValue&&(m.modelValue[s]=e[s])}),m.validateOnSubmit){const s=p();v("validation",s.valid,s.errors),s.valid?v("submit",{...e},!0):v("submit",{...e},!1,{...o})}else v("submit",{...e},b.value,{...o})},x=()=>{V(),v("reset")};return(i,s)=>(f(),c("form",{onSubmit:P,onReset:x,novalidate:""},[R(i.$slots,"default",{form:{values:N(e),errors:N(o),isValid:N(b)}})],32))}});export{pe as _,be as a,ge as b};
