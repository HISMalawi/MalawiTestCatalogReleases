import{_ as x}from"./eA2H0pyo.js";import{_ as B}from"./WCtLych_.js";import{_ as I}from"./Bf0aH3QM.js";import{_ as U}from"./BgOZ5tY3.js";import{d as q,u as N,x as S,y as C,r as f,z as T,o as E,k as $,c as M,b as O,e as t,f as i,g as R,l as n}from"./DSPXqrpM.js";import{u as H}from"./BxMKpl0t.js";import{u as L}from"./CnpgD76R.js";import"./f4feb2ck.js";const A={class:"min-h-screen bg-gray-50 p-5"},D={class:"mx-auto"},F={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},k={class:"w-full py-5 px-5"},P={class:"w-full grid grid-cols-2 gap-5"},j={class:"overflow-hidden"},ae=q({__name:"[id]",setup(z){H({title:"Update specimen | Malawi Test Catalog"});const{$metadata:p,$toast:m}=N(),_=S(),c=C(),{canEdit:b}=L();b.value||(m.error("You don't have permission to edit specimens"),c.push("/app/specimens"));const d=f(!1),l=f(null),a=T({name:"",description:"",iblis_mapping_name:"",preferred_name:"",scientific_name:"",loinc_code:"",moh_code:"",nlims_code:"",id:0,created_at:"",updated_at:""}),v={fields:[{name:"name",label:"Name",rules:{required:!0}},{name:"iblis_mapping_name",label:"IBLIS mapping name",rules:{required:!1}},{name:"preferred_name",label:"Preferred name",rules:{required:!0}},{name:"scientific_name",label:"Scientific name",rules:{required:!1}},{name:"loinc_code",label:"LONIC code",rules:{required:!1}},{name:"moh_code",label:"MOH code",rules:{required:!1}}]};E(async()=>{const u=_.params.id;if(!u){m.error("Invalid specimen ID"),setTimeout(()=>{c.push("/app/specimens")},2e3);return}d.value=!0;try{const e=await p.specimen_types.getById(Number(u));l.value=e,l.value!==null&&Object.keys(a).forEach(s=>{l.value&&s in l.value&&l.value[s]!==void 0&&(a[s]=l.value[s])})}catch{m.error("Failed to fetch specimen data"),setTimeout(()=>{c.push("/app/specimens")},2e3)}finally{d.value=!1}});const g=async(u,e)=>{if(!(!e||!l.value)){d.value=!0;try{const s={...l.value,...a};await p.specimen_types.update(s.id,s),m.success("specimen updated successfully"),setTimeout(()=>{c.push("/app/specimens")},2e3)}catch{m.error("An error occurred while updating specimen")}finally{d.value=!1}}};return(u,e)=>{const s=x,r=B,h=$("RichTextEditor"),V=I,y=U;return O(),M("div",A,[t("div",D,[t("div",F,[i(s,{icon:"healthicons:microscope-with-specimen-outline",title:"Edit specimen",description:"Modify details of the specimen"}),t("div",k,[i(y,{config:v,onSubmit:g},{default:R(({form:w})=>[t("div",P,[i(r,{name:"name",label:"Name",modelValue:n(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>n(a).name=o),required:""},null,8,["modelValue"]),i(r,{name:"preferred_name",label:"Preferred name",modelValue:n(a).preferred_name,"onUpdate:modelValue":e[1]||(e[1]=o=>n(a).preferred_name=o),required:""},null,8,["modelValue"]),i(r,{name:"iblis_mapping_name",label:"IBLIS mapping name",modelValue:n(a).iblis_mapping_name,"onUpdate:modelValue":e[2]||(e[2]=o=>n(a).iblis_mapping_name=o)},null,8,["modelValue"]),i(r,{name:"scientific_name",label:"Scientific name",modelValue:n(a).scientific_name,"onUpdate:modelValue":e[3]||(e[3]=o=>n(a).scientific_name=o)},null,8,["modelValue"]),i(r,{name:"loinc_code",label:"LONIC code",modelValue:n(a).loinc_code,"onUpdate:modelValue":e[4]||(e[4]=o=>n(a).loinc_code=o)},null,8,["modelValue"]),i(r,{name:"moh_code",label:"MOH code",modelValue:n(a).moh_code,"onUpdate:modelValue":e[5]||(e[5]=o=>n(a).moh_code=o)},null,8,["modelValue"]),t("div",null,[e[7]||(e[7]=t("label",{for:"description",class:"block font-medium text-gray-700 mb-2"},"Description",-1)),t("div",j,[i(h,{theme:"snow",class:"editor",content:n(a).description,"onUpdate:content":e[6]||(e[6]=o=>n(a).description=o),contentType:"html"},null,8,["content"])])])]),i(V,{disabled:!w.isValid,class:"mt-4",label:"Update",loading:n(d),type:"submit"},null,8,["disabled","loading"])]),_:1})])])])])}}});export{ae as default};
