import{_ as y}from"./eA2H0pyo.js";import{_ as x}from"./WCtLych_.js";import{_ as q}from"./Cy6ejAbI.js";import{_ as C}from"./Bf0aH3QM.js";import{_ as B}from"./BgOZ5tY3.js";import{d as N,u as U,j as O,r as u,o as S,k as T,c as $,b as A,e as s,f as l,g as k,l as n,m as D}from"./DSPXqrpM.js";import{u as E}from"./BxMKpl0t.js";import{u as H}from"./CnpgD76R.js";import"./f4feb2ck.js";const M={class:"min-h-screen bg-gray-50 p-5"},R={class:"mx-auto"},I={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},P={class:"w-full py-5 px-5"},F={class:"w-full grid grid-cols-2 gap-5"},L={class:"overflow-hidden"},oe=N({__name:"create",setup(j){E({title:"Create Organism | Malawi Test Catalog"});const{$metadata:c,$toast:i}=U(),_=O(),{canEdit:f}=H();f.value||(i.error("You don't have permission to create organisms"),_.push("/app/organisms"));const m=u(!1),a=u({name:"",short_name:"",description:"",id:0,created_at:"",updated_at:"",moh_code:null,nlims_code:null,loinc_code:null,preferred_name:null,scientific_name:null,drugs:[]}),p=u([]),g={fields:[{name:"name",label:"Name",rules:{required:!0}},{name:"short_name",label:"Short name",rules:{required:!1}},{name:"preferred_name",label:"Preferred name",rules:{required:!0}},{name:"scientific_name",label:"Scientific name",rules:{required:!1}},{name:"lonic_code",label:"LONIC code",rules:{required:!1}},{name:"moh_code",label:"MOH code",rules:{required:!1}},{name:"drug",label:"Drug",rules:{custom:t=>t&&t.length>0||"Please select at least one drug"}}]},b=async(t,e)=>{if(e){m.value=!0;try{await c.organisms.create(a.value)&&(i.success("Organism created successfully"),setTimeout(()=>{D({path:"/app/organisms"})},3e3))}catch{i.error("An error occurred while creating organism")}finally{m.value=!1}}};return S(async()=>{const t=await c.drugs.getAll();p.value=t}),(t,e)=>{const d=y,r=x,V=T("RichTextEditor"),h=q,v=C,w=B;return A(),$("div",M,[s("div",R,[s("div",I,[l(d,{icon:"healthicons:virus-outline",title:"Create New Organism",description:"Add details of a new organism"}),s("div",P,[l(w,{config:g,onSubmit:b},{default:k(({form:Y})=>[s("div",F,[l(r,{name:"name",label:"Name",modelValue:n(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>n(a).name=o),required:""},null,8,["modelValue"]),l(r,{name:"short_name",label:"Short name",modelValue:n(a).short_name,"onUpdate:modelValue":e[1]||(e[1]=o=>n(a).short_name=o)},null,8,["modelValue"]),l(r,{name:"preferred_name",label:"Preferred name",modelValue:n(a).preferred_name,"onUpdate:modelValue":e[2]||(e[2]=o=>n(a).preferred_name=o),required:""},null,8,["modelValue"]),l(r,{name:"scientific_name",label:"Scientific name",modelValue:n(a).scientific_name,"onUpdate:modelValue":e[3]||(e[3]=o=>n(a).scientific_name=o)},null,8,["modelValue"]),l(r,{name:"lonic_code",label:"LONIC code",modelValue:n(a).loinc_code,"onUpdate:modelValue":e[4]||(e[4]=o=>n(a).loinc_code=o)},null,8,["modelValue"]),l(r,{name:"moh_code",label:"MOH code",modelValue:n(a).moh_code,"onUpdate:modelValue":e[5]||(e[5]=o=>n(a).moh_code=o)},null,8,["modelValue"]),s("div",null,[e[8]||(e[8]=s("label",{for:"description",class:"block font-medium text-gray-700 mb-2"},"Description",-1)),s("div",L,[l(V,{theme:"snow",class:"editor",content:n(a).description,"onUpdate:content":e[6]||(e[6]=o=>n(a).description=o),contentType:"html"},null,8,["content"])])]),l(h,{name:"drug",label:"Drug(s)","is-multiple":"",modelValue:n(a).drugs,"onUpdate:modelValue":e[7]||(e[7]=o=>n(a).drugs=o),options:n(p).map(o=>({...o,label:o.name})),required:""},null,8,["modelValue","options"])]),l(v,{class:"mt-4",label:"Submit",loading:n(m),type:"submit"},null,8,["loading"])]),_:1})])])])])}}});export{oe as default};
