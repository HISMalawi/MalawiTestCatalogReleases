import{_ as w}from"./eA2H0pyo.js";import{_ as x}from"./WCtLych_.js";import{_ as U}from"./Bf0aH3QM.js";import{_ as q}from"./BgOZ5tY3.js";import{d as B,u as D,x as N,y as C,r as f,z as I,o as S,k as T,c as $,b as E,e as s,f as r,g as O,l as a}from"./DSPXqrpM.js";import{u as R}from"./CnpgD76R.js";import"./f4feb2ck.js";const M={class:"min-h-screen bg-gray-50 p-5"},A={class:"mx-auto"},F={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},H={class:"w-full py-5 px-5"},k={class:"w-full grid grid-cols-2 gap-5"},L={class:"overflow-hidden"},Z=B({__name:"[id]",setup(P){const{$metadata:p,$toast:i}=D(),_=N(),m=C(),{canEdit:g}=R();g.value||(i.error("You don't have permission to edit drugs"),m.push("/app/drugs"));const u=f(!1),l=f(null),o=I({name:"",short_name:"",description:"",preferred_name:"",scientific_name:"",loinc_code:"",moh_code:"",nlims_code:"",id:0,created_at:"",updated_at:""}),v={fields:[{name:"name",label:"Name",rules:{required:!0}},{name:"short_name",label:"Short name",rules:{required:!1}},{name:"preferred_name",label:"Preferred name",rules:{required:!0}},{name:"scientific_name",label:"Scientific name",rules:{required:!1}},{name:"loinc_code",label:"LONIC code",rules:{required:!1}},{name:"moh_code",label:"MOH code",rules:{required:!1}}]};S(async()=>{const c=_.params.id;if(!c){i.error("Invalid drug ID"),setTimeout(()=>{m.push("/app/drugs")},3e3);return}u.value=!0;try{const e=await p.drugs.getById(Number(c));l.value=e,l.value!==null&&Object.keys(o).forEach(n=>{l.value&&n in l.value&&l.value[n]!==void 0&&(o[n]=l.value[n])})}catch{i.error("Failed to fetch drug data"),setTimeout(()=>{m.push("/app/drugs")},3e3)}finally{u.value=!1}});const h=async(c,e)=>{if(!(!e||!l.value)){u.value=!0;try{const n={...l.value,...o};await p.drugs.update(n.id,n),i.success("Drug updated successfully"),setTimeout(()=>{m.push("/app/drugs")},3e3)}catch{i.error("An error occurred while updating drug")}finally{u.value=!1}}};return(c,e)=>{const n=w,d=x,b=T("RichTextEditor"),V=U,y=q;return E(),$("div",M,[s("div",A,[s("div",F,[r(n,{mode:"primary",icon:"healthicons:medicines-outline",title:"Update Drug",description:"Modify details of the drug"}),s("div",H,[r(y,{config:v,onSubmit:h},{default:O(({form:z})=>[s("div",k,[r(d,{name:"name",label:"Name",modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(o).name=t),required:""},null,8,["modelValue"]),r(d,{name:"short_name",label:"Short name",modelValue:a(o).short_name,"onUpdate:modelValue":e[1]||(e[1]=t=>a(o).short_name=t)},null,8,["modelValue"]),r(d,{name:"preferred_name",label:"Preferred name",modelValue:a(o).preferred_name,"onUpdate:modelValue":e[2]||(e[2]=t=>a(o).preferred_name=t),required:""},null,8,["modelValue"]),r(d,{name:"scientific_name",label:"Scientific name",modelValue:a(o).scientific_name,"onUpdate:modelValue":e[3]||(e[3]=t=>a(o).scientific_name=t)},null,8,["modelValue"]),r(d,{name:"loinc_code",label:"LONIC code",modelValue:a(o).loinc_code,"onUpdate:modelValue":e[4]||(e[4]=t=>a(o).loinc_code=t)},null,8,["modelValue"]),r(d,{name:"moh_code",label:"MOH code",modelValue:a(o).moh_code,"onUpdate:modelValue":e[5]||(e[5]=t=>a(o).moh_code=t)},null,8,["modelValue"]),s("div",null,[e[7]||(e[7]=s("label",{for:"description",class:"block font-medium text-gray-700 mb-2"},"Description",-1)),s("div",L,[r(b,{theme:"snow",class:"editor",content:a(o).description,"onUpdate:content":e[6]||(e[6]=t=>a(o).description=t),contentType:"html"},null,8,["content"])])])]),r(V,{class:"mt-4",label:"Update",loading:a(u),type:"submit"},null,8,["loading"])]),_:1})])])])])}}});export{Z as default};
