import{_ as w}from"./eA2H0pyo.js";import{_ as V}from"./WCtLych_.js";import{_ as x}from"./Bf0aH3QM.js";import{_ as B}from"./BgOZ5tY3.js";import{d as N,u as U,x as C,y as T,r as f,z as I,o as $,k as M,c as O,b as P,e as r,f as d,g as q,l as a}from"./DSPXqrpM.js";import{u as E}from"./BxMKpl0t.js";import"./f4feb2ck.js";const H={class:"min-h-screen bg-gray-50 p-5"},R={class:"mx-auto"},D={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},F={class:"w-full py-5 px-5"},k={class:"w-full grid grid-cols-2 gap-5"},A={class:"overflow-hidden"},Y=N({__name:"[id]",setup(L){E({title:"Update Product | Malawi Test Catalog",meta:[{name:"description",content:"Update product details"}]});const{$metadata:p,$toast:c}=U(),_=C(),u=T(),l=f(!1),s=f(null),o=I({name:"",description:"",loinc_code:"",moh_code:"",nlims_code:"",id:0,created_at:"",updated_at:""}),v={fields:[{name:"name",label:"Name",rules:{required:!0}},{name:"loinc_code",label:"LONIC code",rules:{required:!1}},{name:"moh_code",label:"MOH code",rules:{required:!1}}]};$(async()=>{const i=_.params.id;if(!i){c.error("Invalid product ID"),setTimeout(()=>{u.push("/app/products")},3e3);return}l.value=!0;try{const e=await p.products.getById(Number(i));s.value=e,s.value!==null&&Object.keys(o).forEach(t=>{s.value&&t in s.value&&s.value[t]!==void 0&&(o[t]=s.value[t])})}catch{c.error("Failed to fetch product data"),setTimeout(()=>{u.push("/app/products")},3e3)}finally{l.value=!1}});const h=async(i,e)=>{if(!(!e||!s.value)){l.value=!0;try{const t={...s.value,...o};await p.products.update(t.id,t),c.success("Product updated successfully"),setTimeout(()=>{u.push("/app/products")},3e3)}catch{c.error("An error occurred while updating product")}finally{l.value=!1}}};return(i,e)=>{const t=w,m=V,b=M("RichTextEditor"),g=x,y=B;return P(),O("div",H,[r("div",R,[r("div",D,[d(t,{mode:"primary",icon:"eos-icons:products-outlined",title:"Update Product",description:"Modify details of the product"}),r("div",F,[d(y,{config:v,onSubmit:h},{default:q(({form:j})=>[r("div",k,[d(m,{name:"name",label:"Name",modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=n=>a(o).name=n),required:""},null,8,["modelValue"]),d(m,{name:"loinc_code",label:"LONIC code",modelValue:a(o).loinc_code,"onUpdate:modelValue":e[1]||(e[1]=n=>a(o).loinc_code=n)},null,8,["modelValue"]),d(m,{name:"moh_code",label:"MOH code",modelValue:a(o).moh_code,"onUpdate:modelValue":e[2]||(e[2]=n=>a(o).moh_code=n)},null,8,["modelValue"]),r("div",null,[e[4]||(e[4]=r("label",{for:"description",class:"block font-medium text-gray-700 mb-2"},"Description",-1)),r("div",A,[d(b,{theme:"snow",class:"editor",content:a(o).description,"onUpdate:content":e[3]||(e[3]=n=>a(o).description=n),contentType:"html"},null,8,["content"])])])]),d(g,{class:"mt-4",label:"Update",loading:a(l),type:"submit"},null,8,["loading"])]),_:1})])])])])}}});export{Y as default};
