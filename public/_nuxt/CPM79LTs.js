import{_ as R}from"./C9jAmNbZ.js";import{_ as B}from"./CSyLZfXx.js";import{_ as j}from"./DVOtJaNl.js";import{_ as P}from"./fOVD2dkZ.js";import{d as O,r as x,j as C,c as E,b as L,F,e,f as a,k as n,g as d,t as k,u as U,m as S,o as q,i as G,p as M,x as Y,l as z}from"./PjMfiYHK.js";import{S as K,Y as J,h as H,G as Q,V as W}from"./C00CHmfA.js";import{_ as X}from"./D-_7y58P.js";import{d as p}from"./BtSipvlV.js";import{D,a as Z}from"./BugC5oc-.js";import{u as ee}from"./CWorKg9L.js";import"./DmRZQY_I.js";import"./Cpj98o6Y.js";const te={class:"fixed inset-0 overflow-y-auto"},se={class:"flex min-h-full items-center justify-center p-4 text-center"},oe={class:"px-5 py-5"},ae={class:"w-full border-b pb-2 border-gray-100"},ne={class:"text-lg font-semibold text-black"},le={class:"w-full border-b pb-2 border-gray-100"},re={class:"text-lg font-semibold text-black"},ie={class:"w-full border-b pb-2 border-gray-100"},de={class:"text-lg font-semibold text-black"},ce={class:"w-full border-b pb-2 border-gray-100"},ue=["innerHTML"],me={class:"w-full border-b pb-2 border-gray-100"},pe=["innerHTML"],fe={class:"w-full border-b pb-2 border-gray-100"},_e=["innerHTML"],ge={class:"w-full border-b pb-2 border-gray-100"},xe=["innerHTML"],be={class:"px-5 py-2 border-t border-gray-100 flex items-center justify-end"},ve=O({__name:"ViewDialog",props:{drug:{type:Object,required:!0}},setup(N){const i=N,f=x(!1),_=()=>{f.value=!1},u=()=>{f.value=!0};return(v,t)=>{const T=C("Icon"),b=j,$=P;return L(),E(F,null,[e("button",{onClick:u,class:"cursor-pointer"},[a(T,{icon:"lets-icons:view-alt-duotone",class:"w-5 h-5 mr-1"})]),a(n(K),{appear:"",show:f.value,as:"template"},{default:d(()=>[a(n(J),{as:"div",onClose:_,class:"relative z-10"},{default:d(()=>[a(n(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>t[0]||(t[0]=[e("div",{class:"fixed inset-0 bg-black/25"},null,-1)])),_:1}),e("div",te,[e("div",se,[a(n(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[a(n(Q),{class:"w-full max-w-xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[a(n(W),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:d(()=>[a(b,{icon:"healthicons:medicines-outline",title:`${i.drug.name}`,description:"Viewing details of the drug"},null,8,["title"])]),_:1}),e("div",oe,[e("div",ae,[t[1]||(t[1]=e("h3",{class:"text-gray-500 font-base"},"Name",-1)),e("p",ne,k(i.drug.name),1)]),e("div",le,[t[2]||(t[2]=e("h3",{class:"text-gray-500 font-base"},"Preferred name",-1)),e("p",re,k(i.drug.preferred_name),1)]),e("div",ie,[t[3]||(t[3]=e("h3",{class:"text-gray-500 font-base"},"Scientific name",-1)),e("p",de,k(i.drug.scientific_name),1)]),e("div",ce,[t[4]||(t[4]=e("h3",{class:"text-gray-500 font-base"},"Description",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:i.drug.description},null,8,ue)]),e("div",me,[t[5]||(t[5]=e("h3",{class:"text-gray-500 font-base"},"LOINC Code",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:i.drug.loinc_code},null,8,pe)]),e("div",fe,[t[6]||(t[6]=e("h3",{class:"text-gray-500 font-base"},"MOH Code",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:i.drug.moh_code},null,8,_e)]),e("div",ge,[t[7]||(t[7]=e("h3",{class:"text-gray-500 font-base"},"NLIMS Code",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:i.drug.nlims_code},null,8,xe)])]),e("div",be,[a($,{label:"Close",onClick:_})])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])],64)}}}),we={class:"px-4 py-8"},he={class:"w-full flex items-center justify-between flex-wrap gap-4"},ye={class:"flex items-center space-x-4"},De={class:"max-w-md w-full"},Ce={class:"mt-5"},Te={class:"w-full flex items-center justify-between bg-white p-2 border border-gray-100 rounded my-2 px-2"},$e={class:"w-full flex items-center flex-wrap md:flex-nowrap gap-3"},ke={class:"flex items-center flex-wrap sm:flex-nowrap gap-2"},Me={class:"w-full sm:w-auto"},Ee={class:"overflow-x-auto"},Le=["innerHTML"],Ne={class:"flex items-center space-x-3"},Ae=["onClick"],Se={class:"cursor-pointer"},ze=O({__name:"index",setup(N){ee({title:"Drugs | Malawi Test Catalog"});const{$metadata:i,$toast:f}=U(),_=x(!1),u=x(""),v=x([]),t=x([]),T=[{text:"NAME",value:"name"},{text:"SHORT NAME",value:"short_name"},{text:"OTHER NAMES",value:"preferred_name"},{text:"DESCRIPTION",value:"description"},{text:"NLIMS CODE",value:"nlims_code"},{text:"DATE CREATED",value:"created_at"},{text:"ACTIONS",value:"actions"}],b=x([]),$=S(()=>{var s;let o=b.value.filter(l=>{var g,m,w,h,y;if(!u.value)return!0;const c=u.value.toLowerCase();return((g=l.name)==null?void 0:g.toLowerCase().includes(c))||((m=l.short_name)==null?void 0:m.toLowerCase().includes(c))||((w=l.preferred_name)==null?void 0:w.toLowerCase().includes(c))||((h=l.nlims_code)==null?void 0:h.toLowerCase().includes(c))||((y=l.description)==null?void 0:y.toLowerCase().includes(c))});if(((s=t.value)==null?void 0:s.length)===2&&t.value[0]&&t.value[1]){const l=p(t.value[0]).startOf("day"),c=p(t.value[1]).endOf("day");o=o.filter(g=>{const m=p(g.created_at);return m.isAfter(l)&&m.isBefore(c)})}return o.map(l=>({...l,created_at:p(l.created_at).format(D)}))}),I=S(()=>({name:`malawi-test-catalog-drugs-${p().format(D)}`,headers:["Malawi Test Catalog Drugs","Report Date: "+p().format(D)],data:b.value.map(o=>({NAME:o.name,"SHORT NAME":o.short_name,"OTHER NAMES":o.preferred_name,DESCRIPTION:o.description,"NLIMS CODE":o.nlims_code,"DATE CREATED":p(o.created_at).format(D)}))})),A=async()=>{_.value=!0;try{const o=await i.drugs.getAll();o&&(b.value=o)}catch(o){console.error(o),f.error("An error occurred while fetching drugs")}finally{_.value=!1}},V=async()=>{f.success("Drug deleted successfully"),A()};return q(()=>{A()}),(o,s)=>{const l=C("Icon"),c=R,g=B,m=C("Datepicker"),w=ve,h=X,y=C("datatable");return L(),E("div",we,[e("div",null,[s[6]||(s[6]=e("h1",{class:"text-3xl font-semibold mb-6"},"Drugs",-1)),e("div",he,[e("div",ye,[e("button",{onClick:s[0]||(s[0]=r=>o.$router.push("/app/drugs/create")),class:"cursor-pointer bg-emerald-600 hover:bg-emerald-700 transition duration-150 flex items-center text-emerald-100 px-2.5 py-2 rounded"},[a(l,{icon:"mdi:plus",class:"w-5 h-5 mr-1"}),s[5]||(s[5]=G(" Add new "))]),a(c,{"export-data":n(I)},null,8,["export-data"])]),e("div",De,[a(g,{modelValue:n(u),"onUpdate:modelValue":s[1]||(s[1]=r=>M(u)?u.value=r:null),placeholder:"Search..."},null,8,["modelValue"])])])]),e("div",Ce,[e("div",Te,[e("div",$e,[e("div",ke,[s[7]||(s[7]=e("p",{class:"whitespace-nowrap"},[e("span",{class:"text-base font-medium"},"Date created:")],-1)),e("div",Me,[a(m,{required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker w-full",modelValue:n(t),"onUpdate:modelValue":s[2]||(s[2]=r=>M(t)?t.value=r:null),format:n(Z),maxDate:new Date},null,8,["modelValue","format","maxDate"])]),n(t)&&n(t).length?(L(),E("button",{key:0,onClick:s[3]||(s[3]=r=>t.value=[]),class:"px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm"}," Clear ")):Y("",!0)])])]),e("div",Ee,[a(y,{"table-class-name":"datatable w-full",headers:T,items:n($),"items-selected":n(v),"onUpdate:itemsSelected":s[4]||(s[4]=r=>M(v)?v.value=r:null),alternating:"",loading:n(_)},{loading:d(()=>s[8]||(s[8]=[e("svg",{class:"w-15 h-15 text-emerald-600",width:"38",height:"38",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"oklch(0.596 0.145 163.225)"},[e("g",{fill:"none","fill-rule":"evenodd"},[e("g",{transform:"translate(1 1)","stroke-width":"2"},[e("circle",{"stroke-opacity":".5",cx:"18",cy:"18",r:"18"}),e("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[e("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})])])])],-1)])),"item-description":d(r=>[e("div",{innerHTML:r.description},null,8,Le)]),"item-actions":d(r=>[e("div",Ne,[a(w,{drug:r},null,8,["drug"]),e("button",{onClick:He=>("navigateTo"in o?o.navigateTo:n(z))(`/app/drugs/update/${r.id}`),class:"cursor-pointer"},[a(l,{icon:"fa:edit",class:"w-5 h-5"})],8,Ae),a(h,{property:{id:r.id,name:"drugs",endpoint:"drugs"},onConfirm:V},{default:d(()=>[e("button",Se,[a(l,{icon:"mdi:delete",class:"w-5 h-5 mr-1"})])]),_:2},1032,["property"])])]),_:1},8,["items","items-selected","loading"])])])])}}});export{ze as default};
