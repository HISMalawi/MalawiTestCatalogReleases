import{u as L,ao as S,P as q,r as m,p as h}from"./DSPXqrpM.js";function A(a,e){const n=e/a*100;return 2/Math.PI*100*Math.atan(n/50)}function E(a={}){const{duration:e=2e3,throttle:n=200,hideDelay:k=500,resetDelay:F=400}=a,M=a.estimatedProgress||A,u=L(),i=m(0),s=m(!1),d=m(!1);let f=!1,g,p,v,T;const _=(t={})=>{d.value=!1,I(0,t)};function I(t=0,o={}){if(u.isHydrating)return;if(t>=100)return l({force:o.force});c(),i.value=t<0?0:t;const r=o.force?0:n;r?p=setTimeout(()=>{s.value=!0,D()},r):(s.value=!0,D())}function b(){v=setTimeout(()=>{s.value=!1,T=setTimeout(()=>{i.value=0},F)},k)}function l(t={}){i.value=100,f=!0,c(),y(),t.error&&(d.value=!0),t.force?(i.value=0,s.value=!1):b()}function y(){clearTimeout(v),clearTimeout(T)}function c(){clearTimeout(p),cancelAnimationFrame(g)}function D(){f=!1;let t;function o(r){if(f)return;t??(t=r);const H=r-t;i.value=Math.max(0,Math.min(100,M(e,H))),g=requestAnimationFrame(o)}g=requestAnimationFrame(o)}let P=()=>{};{const t=u.hook("page:loading:start",()=>{_()}),o=u.hook("page:loading:end",()=>{l()}),r=u.hook("vue:error",()=>l());P=()=>{r(),t(),o(),c()}}return{_cleanup:P,progress:h(()=>i.value),isLoading:h(()=>s.value),error:h(()=>d.value),start:_,set:I,finish:l,clear:c}}function C(a={}){const e=L(),n=e._loadingIndicator||(e._loadingIndicator=E(a));return S()&&(e._loadingIndicatorDeps||(e._loadingIndicatorDeps=0),e._loadingIndicatorDeps++,q(()=>{e._loadingIndicatorDeps--,e._loadingIndicatorDeps===0&&(n._cleanup(),delete e._loadingIndicator)})),n}export{C as u};
