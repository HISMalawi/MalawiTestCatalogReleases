import{_ as j}from"./B-WsDPk8.js";import{_ as P}from"./Bcsf2iPY.js";import{_ as q}from"./eA2H0pyo.js";import{_ as F}from"./Bf0aH3QM.js";import{d as I,r as b,k as E,c as h,b as v,F as U,e,f as n,l as a,g as c,t as L,u as G,p as H,o as Y,q as k,i as z,s as A,v as K,m as J}from"./DSPXqrpM.js";import{S as Q,Y as W,h as O,G as X,V as Z}from"./BhFxkj3L.js";import{_ as ee}from"./Cf3ca5Xh.js";import{d as p}from"./BtSipvlV.js";import{D as $,a as te}from"./BugC5oc-.js";import{u as se}from"./BxMKpl0t.js";import{u as oe}from"./CnpgD76R.js";import"./CyCQu6eQ.js";import"./Cpj98o6Y.js";const ae={class:"fixed inset-0 overflow-y-auto"},ne={class:"flex min-h-full items-center justify-center p-4 text-center"},re={class:"px-5 py-5"},le={class:"w-full border-b pb-2 border-gray-100"},ie={class:"text-lg font-semibold text-black"},de={class:"w-full border-b pb-2 border-gray-100"},ce={class:"text-lg font-semibold text-black"},ue={class:"w-full border-b pb-2 border-gray-100"},me={class:"text-lg font-semibold text-black"},pe={class:"w-full border-b pb-2 border-gray-100"},fe=["innerHTML"],_e={class:"w-full border-b pb-2 border-gray-100"},ge=["innerHTML"],xe={class:"w-full border-b pb-2 border-gray-100"},be=["innerHTML"],ve={class:"w-full border-b pb-2 border-gray-100"},we=["innerHTML"],ye={class:"px-5 py-2 border-t border-gray-100 flex items-center justify-end"},he=I({__name:"ViewDialog",props:{drug:{type:Object,required:!0}},setup(N){const d=N,f=b(!1),_=()=>{f.value=!1},w=()=>{f.value=!0};return(g,s)=>{const l=E("Icon"),M=q,y=F;return v(),h(U,null,[e("button",{onClick:w,class:"cursor-pointer"},[n(l,{icon:"lets-icons:view-alt-duotone",class:"w-5 h-5 mr-1"})]),n(a(Q),{appear:"",show:f.value,as:"template"},{default:c(()=>[n(a(W),{as:"div",onClose:_,class:"relative z-10"},{default:c(()=>[n(a(O),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>s[0]||(s[0]=[e("div",{class:"fixed inset-0 bg-black/25"},null,-1)])),_:1}),e("div",ae,[e("div",ne,[n(a(O),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[n(a(X),{class:"w-full max-w-xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[n(a(Z),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900"},{default:c(()=>[n(M,{icon:"healthicons:medicines-outline",title:`${d.drug.name}`,description:"Viewing details of the drug"},null,8,["title"])]),_:1}),e("div",re,[e("div",le,[s[1]||(s[1]=e("h3",{class:"text-gray-500 font-base"},"Name",-1)),e("p",ie,L(d.drug.name),1)]),e("div",de,[s[2]||(s[2]=e("h3",{class:"text-gray-500 font-base"},"Preferred name",-1)),e("p",ce,L(d.drug.preferred_name),1)]),e("div",ue,[s[3]||(s[3]=e("h3",{class:"text-gray-500 font-base"},"Scientific name",-1)),e("p",me,L(d.drug.scientific_name),1)]),e("div",pe,[s[4]||(s[4]=e("h3",{class:"text-gray-500 font-base"},"Description",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:d.drug.description},null,8,fe)]),e("div",_e,[s[5]||(s[5]=e("h3",{class:"text-gray-500 font-base"},"LOINC Code",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:d.drug.loinc_code},null,8,ge)]),e("div",xe,[s[6]||(s[6]=e("h3",{class:"text-gray-500 font-base"},"MOH Code",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:d.drug.moh_code},null,8,be)]),e("div",ve,[s[7]||(s[7]=e("h3",{class:"text-gray-500 font-base"},"NLIMS Code",-1)),e("p",{class:"text-lg font-semibold text-black",innerHTML:d.drug.nlims_code},null,8,we)])]),e("div",ye,[n(y,{label:"Close",onClick:_})])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])],64)}}}),De={class:"px-4 py-8"},Ce={class:"w-full flex items-center justify-between flex-wrap gap-4"},Te={class:"flex items-center space-x-4"},ke={class:"max-w-md w-full"},$e={class:"mt-5"},Ee={class:"w-full flex items-center justify-between bg-white p-2 border border-gray-100 rounded my-2 px-2"},Me={class:"w-full flex items-center flex-wrap md:flex-nowrap gap-3"},Le={class:"flex items-center flex-wrap sm:flex-nowrap gap-2"},Ae={class:"w-full sm:w-auto"},Ne={class:"overflow-x-auto"},Se=["innerHTML"],He={class:"flex items-center space-x-3"},Oe=["onClick"],Ie={class:"cursor-pointer"},We=I({__name:"index",setup(N){se({title:"Drugs | Malawi Test Catalog"});const{$metadata:d,$toast:f}=G(),{canEdit:_}=oe(),w=b(!1),g=b(""),s=b([]),l=b([]),M=[{text:"NAME",value:"name"},{text:"SHORT NAME",value:"short_name"},{text:"OTHER NAMES",value:"preferred_name"},{text:"DESCRIPTION",value:"description"},{text:"NLIMS CODE",value:"nlims_code"},{text:"DATE CREATED",value:"created_at"},{text:"ACTIONS",value:"actions"}],y=b([]),V=H(()=>{var t;let o=y.value.filter(r=>{var x,m,D,C,T;if(!g.value)return!0;const u=g.value.toLowerCase();return((x=r.name)==null?void 0:x.toLowerCase().includes(u))||((m=r.short_name)==null?void 0:m.toLowerCase().includes(u))||((D=r.preferred_name)==null?void 0:D.toLowerCase().includes(u))||((C=r.nlims_code)==null?void 0:C.toLowerCase().includes(u))||((T=r.description)==null?void 0:T.toLowerCase().includes(u))});if(((t=l.value)==null?void 0:t.length)===2&&l.value[0]&&l.value[1]){const r=p(l.value[0]).startOf("day"),u=p(l.value[1]).endOf("day");o=o.filter(x=>{const m=p(x.created_at);return m.isAfter(r)&&m.isBefore(u)})}return o.map(r=>({...r,created_at:p(r.created_at).format($)}))}),R=H(()=>({name:`malawi-test-catalog-drugs-${p().format($)}`,headers:["Malawi Test Catalog Drugs","Report Date: "+p().format($)],data:y.value.map(o=>({NAME:o.name,"SHORT NAME":o.short_name,"OTHER NAMES":o.preferred_name,DESCRIPTION:o.description,"NLIMS CODE":o.nlims_code,"DATE CREATED":p(o.created_at).format($)}))})),S=async()=>{w.value=!0;try{const o=await d.drugs.getAll();o&&(y.value=o)}catch(o){console.error(o),f.error("An error occurred while fetching drugs")}finally{w.value=!1}},B=async()=>{f.success("Drug deleted successfully"),S()};return Y(()=>{S()}),(o,t)=>{const r=E("Icon"),u=j,x=P,m=E("Datepicker"),D=he,C=ee,T=E("datatable");return v(),h("div",De,[e("div",null,[t[6]||(t[6]=e("h1",{class:"text-3xl font-semibold mb-6"},"Drugs",-1)),e("div",Ce,[e("div",Te,[a(_)?(v(),h("button",{key:0,onClick:t[0]||(t[0]=i=>o.$router.push("/app/drugs/create")),class:"cursor-pointer bg-emerald-600 hover:bg-emerald-700 transition duration-150 flex items-center text-emerald-100 px-2.5 py-2 rounded"},[n(r,{icon:"mdi:plus",class:"w-5 h-5 mr-1"}),t[5]||(t[5]=z(" Add new "))])):k("",!0),n(u,{"export-data":a(R)},null,8,["export-data"])]),e("div",ke,[n(x,{modelValue:a(g),"onUpdate:modelValue":t[1]||(t[1]=i=>A(g)?g.value=i:null),placeholder:"Search..."},null,8,["modelValue"])])])]),e("div",$e,[e("div",Ee,[e("div",Me,[e("div",Le,[t[7]||(t[7]=e("p",{class:"whitespace-nowrap"},[e("span",{class:"text-base font-medium"},"Date created:")],-1)),e("div",Ae,[n(m,{required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker w-full",modelValue:a(l),"onUpdate:modelValue":t[2]||(t[2]=i=>A(l)?l.value=i:null),format:a(te),maxDate:new Date},null,8,["modelValue","format","maxDate"])]),a(l)&&a(l).length?(v(),h("button",{key:0,onClick:t[3]||(t[3]=i=>l.value=[]),class:"px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm"}," Clear ")):k("",!0)])])]),e("div",Ne,[n(T,{"table-class-name":"datatable w-full",headers:M,items:a(V),"items-selected":a(s),"onUpdate:itemsSelected":t[4]||(t[4]=i=>A(s)?s.value=i:null),alternating:"",loading:a(w)},{loading:c(()=>t[8]||(t[8]=[e("svg",{class:"w-15 h-15 text-emerald-600",width:"38",height:"38",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"oklch(0.596 0.145 163.225)"},[e("g",{fill:"none","fill-rule":"evenodd"},[e("g",{transform:"translate(1 1)","stroke-width":"2"},[e("circle",{"stroke-opacity":".5",cx:"18",cy:"18",r:"18"}),e("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[e("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})])])])],-1)])),"item-description":c(i=>[e("div",{innerHTML:i.description},null,8,Se)]),"item-actions":c(i=>[e("div",He,[n(D,{drug:i},null,8,["drug"]),a(_)?(v(),h("button",{key:0,onClick:Ve=>("navigateTo"in o?o.navigateTo:a(J))(`/app/drugs/update/${i.id}`),class:"cursor-pointer"},[n(r,{icon:"fa:edit",class:"w-5 h-5"})],8,Oe)):k("",!0),a(_)?(v(),K(C,{key:1,property:{id:i.id,name:"drugs",endpoint:"drugs"},onConfirm:B},{default:c(()=>[e("button",Ie,[n(r,{icon:"mdi:delete",class:"w-5 h-5 mr-1"})])]),_:2},1032,["property"])):k("",!0)])]),_:1},8,["items","items-selected","loading"])])])])}}});export{We as default};
