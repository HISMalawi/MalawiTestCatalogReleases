import{_ as y}from"./DVOtJaNl.js";import{_ as w}from"./BXFRxcxa.js";import{_ as U}from"./fOVD2dkZ.js";import{_ as q}from"./NlL6ZmLo.js";import{d as x,u as B,q as D,s as N,r as f,v as C,o as T,j as I,c as S,b as $,e as d,f as r,g as M,k as a}from"./PjMfiYHK.js";import{u as O}from"./CWorKg9L.js";import"./Ste0I7My.js";const E={class:"min-h-screen bg-gray-50 p-5"},H={class:"mx-auto"},R={class:"bg-white rounded-lg border border-gray-100 overflow-hidden"},F={class:"w-full py-5 px-5"},j={class:"w-full grid grid-cols-2 gap-5"},k={class:"overflow-hidden"},Y=x({__name:"[id]",setup(A){O({title:"Update Department | Malawi Test Catalog",meta:[{name:"description",content:"Update department details"}]});const{$metadata:p,$toast:i}=B(),_=D(),c=N(),m=f(!1),l=f(null),t=C({name:"",short_name:"",description:"",preferred_name:"",scientific_name:"",loinc_code:"",moh_code:"",nlims_code:"",id:0,created_at:"",updated_at:""}),v={fields:[{name:"name",label:"Name",rules:{required:!0}},{name:"short_name",label:"Short name",rules:{required:!1}},{name:"preferred_name",label:"Preferred name",rules:{required:!0}},{name:"scientific_name",label:"Scientific name",rules:{required:!1}},{name:"loinc_code",label:"LONIC code",rules:{required:!1}},{name:"moh_code",label:"MOH code",rules:{required:!1}}]};T(async()=>{const u=_.params.id;if(!u){i.error("Invalid department ID"),setTimeout(()=>{c.push("/app/departments")},2e3);return}m.value=!0;try{const e=await p.departments.getById(Number(u));l.value=e,l.value!==null&&Object.keys(t).forEach(n=>{l.value&&n in l.value&&l.value[n]!==void 0&&(t[n]=l.value[n])})}catch{i.error("Failed to fetch department data"),setTimeout(()=>{c.push("/app/departments")},2e3)}finally{m.value=!1}});const b=async(u,e)=>{if(!(!e||!l.value)){m.value=!0;try{const n={...l.value,...t};await p.departments.update(n.id,n)&&(i.success("Department updated successfully"),setTimeout(()=>{c.push("/app/departments")},2e3))}catch{i.error("An error occurred while updating department")}finally{m.value=!1}}};return(u,e)=>{const n=y,s=w,h=I("RichTextEditor"),V=U,g=q;return $(),S("div",E,[d("div",H,[d("div",R,[r(n,{mode:"primary",icon:"circum:hospital-1",title:"Update Department",description:"Modify details of the department"}),d("div",F,[r(g,{config:v,onSubmit:b},{default:M(({form:P})=>[d("div",j,[r(s,{name:"name",label:"Name",modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o)},null,8,["modelValue"]),r(s,{name:"short_name",label:"Short name",modelValue:a(t).short_name,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).short_name=o),required:""},null,8,["modelValue"]),r(s,{name:"preferred_name",label:"Preferred name",modelValue:a(t).preferred_name,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).preferred_name=o),required:""},null,8,["modelValue"]),r(s,{name:"scientific_name",label:"Scientific name",modelValue:a(t).scientific_name,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).scientific_name=o)},null,8,["modelValue"]),r(s,{name:"loinc_code",label:"LONIC code",modelValue:a(t).loinc_code,"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).loinc_code=o)},null,8,["modelValue"]),r(s,{name:"moh_code",label:"MOH code",modelValue:a(t).moh_code,"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).moh_code=o)},null,8,["modelValue"]),d("div",null,[e[7]||(e[7]=d("label",{for:"description",class:"block font-medium text-gray-700 mb-2"},"Description",-1)),d("div",k,[r(h,{theme:"snow",class:"editor",content:a(t).description,"onUpdate:content":e[6]||(e[6]=o=>a(t).description=o),contentType:"html"},null,8,["content"])])])]),r(V,{class:"mt-4",label:"Update",loading:a(m),type:"submit"},null,8,["loading"])]),_:1})])])])])}}});export{Y as default};
