import{_ as ee}from"./WCtLych_.js";import{d as te,u as oe,r as w,w as E,p as ae,o as se,k as re,c as l,b as n,e,f as i,q as b,F as M,A as L,t as k,i as x,H as c,al as g,X as le,B as ne,g as _,l as y}from"./DSPXqrpM.js";import{_ as de}from"./Bf0aH3QM.js";import{_ as ie}from"./Cy6ejAbI.js";import{Y as ue,_ as me,G as ce,V as pe,J as ge,S as be}from"./BhFxkj3L.js";import"./CyCQu6eQ.js";const fe={class:"mb-8"},ye={class:"flex justify-end mb-4"},xe={class:"flex justify-between mb-4"},_e={class:"font-medium text-lg"},ve=["onClick"],he={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},we={class:"md:col-span-2 relative z-0"},ke={class:"overflow-hidden"},Ve=["id","onUpdate:modelValue"],Ce=["id","onUpdate:modelValue"],Ue={class:"mt-4"},Me={class:"flex justify-between items-center mb-3"},Re=["onClick"],Se={class:"w-full flex items-center justify-between space-x-2"},Te={class:"flex items-center space-x-2"},je={class:"text-lg font-medium text-black"},Ne={class:"font-thin text-sm -mt-1"},$e=["onClick"],Ae={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-3"},Be=["onUpdate:modelValue","id"],qe=["onUpdate:modelValue","id"],De=["onUpdate:modelValue","id"],He=["onUpdate:modelValue","id"],Oe=["onUpdate:modelValue"],Fe={key:1,class:"w-full grid grid-cols-2 gap-5"},Ee=["onUpdate:modelValue"],Le=["onUpdate:modelValue"],Ye={key:0,class:"flex flex-col items-center justify-center"},ze={class:"min-h-screen px-4 text-center"},We=te({__name:"Measure",props:{initialTestCatalog:{required:!0,type:Object},testCatalog:{required:!0,type:Object},errors:{required:!0,type:Object}},emits:["update:testCatalog","measureAdded","measureRemoved","rangeAdded","rangeRemoved"],setup(p,{emit:Y}){const m=p,v=Y,{$metadata:z}=oe(),h=w(!1),V=w([]),f=w({value:null,index:-1}),R=w(null);E(()=>m.initialTestCatalog,a=>{a&&Object.assign(m.testCatalog,a)},{deep:!0}),E(()=>m.testCatalog,a=>{v("update:testCatalog",a)},{deep:!0});const C=a=>V.value.find(o=>o.id===a),S=ae(()=>({name:"Reference",description:"Clinical reference values"})),G=()=>({name:"",short_name:"",unit:"",measure_type_id:6,description:"",loinc_code:"",moh_code:"",nlims_code:"",preferred_name:"",scientific_name:"",measure_ranges_attributes:[]}),J=()=>{m.testCatalog.measures.push(G())},P=a=>{m.testCatalog.measures.splice(a,1),v("measureRemoved",a)},X=(a,o)=>{const u=m.testCatalog.measures[o];u.measure_ranges_attributes.length>0?(f.value={value:a,index:o},h.value=!0):(u.measure_type_id=a.id,R.value=a)},K=()=>{if(f.value.value&&f.value.index>=0){const a=f.value.index,o=f.value.value;m.testCatalog.measures[a].measure_ranges_attributes=[],m.testCatalog.measures[a].measure_type_id=o.id,R.value=o,h.value=!1}},Q=()=>{h.value=!1,f.value={value:null,index:-1}},W=a=>({id:Date.now()+Math.random(),...a==="ranges"?{age_min:null,age_max:null,range_lower:null,range_upper:null,sex:null}:{value:null,interpretation:null}}),Z=a=>{var r;const o=m.testCatalog.measures[a],u=C(o.measure_type_id),U=((r=u==null?void 0:u.structure)==null?void 0:r.type)||"ranges";o.measure_ranges_attributes=Array.isArray(o.measure_ranges_attributes)?o.measure_ranges_attributes:[];const s=W(U);o.measure_ranges_attributes.push(s),v("rangeAdded",a)},I=(a,o)=>{m.testCatalog.measures[a].measure_ranges_attributes.splice(o,1),v("rangeRemoved",a,o)};return se(async()=>{try{const a=await z.measure_types.getAll();V.value=a}catch(a){console.error("Failed to load resourcesbbb:",a)}}),(a,o)=>{const u=ee,U=re("RichTextEditor");return n(),l(M,null,[e("div",null,[e("div",fe,[o[16]||(o[16]=e("div",{class:"w-full flex justify-between items-center mb-4"},[e("div",{class:"bg-gray-50 border-b border-gray-100 px-2 py-2 rounded mb-3 w-full"},[e("h2",{class:"text-xl font-semibold"},"Measures")])],-1)),e("div",ye,[i(de,{label:"Add Measure","icon-start":"mdi:plus",onClick:J})]),(n(!0),l(M,null,L(p.testCatalog.measures,(s,r)=>{var T,j,N,$,A;return n(),l("div",{key:r,class:"mb-8 p-4 bg-gray-50 rounded border border-gray-200"},[e("div",xe,[e("h3",_e,"Measure ("+k(r+1)+")",1),e("button",{type:"button",onClick:t=>P(r),class:"text-red-500 hover:font-medium flex items-center hover:text-red-600 cursor-pointer"},o[0]||(o[0]=[e("svg",{class:"mr-1",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[e("g",{fill:"none"},[e("circle",{cx:"12",cy:"12",r:"9",fill:"currentColor","fill-opacity":"0.25"}),e("path",{stroke:"currentColor","stroke-width":"1.2",d:"M8 12h8"})])],-1),x("Remove ")]),8,ve)]),e("div",he,[e("div",null,[i(u,{label:"Name",name:"measure_name",modelValue:s.name,"onUpdate:modelValue":t=>s.name=t,id:`measure-name-${r}`,"error-message":(T=p.errors.name)==null?void 0:T.message,required:""},null,8,["modelValue","onUpdate:modelValue","id","error-message"])]),e("div",null,[i(u,{label:"Short name",name:"measure_short_name",modelValue:s.short_name,"onUpdate:modelValue":t=>s.short_name=t,id:`measure-short-name-${r}`,"error-message":(j=p.errors.short_name)==null?void 0:j.message},null,8,["modelValue","onUpdate:modelValue","id","error-message"])]),e("div",null,[i(u,{label:"Preferred name",name:"measure_preferred_name",modelValue:s.preferred_name,"onUpdate:modelValue":t=>s.preferred_name=t,id:`measure-preferred-name-${r}`,"error-message":(N=p.errors.preferred_name)==null?void 0:N.message,required:""},null,8,["modelValue","onUpdate:modelValue","id","error-message"])]),e("div",null,[i(u,{label:"Scientific name",name:"measure_scientific_name",modelValue:s.scientific_name,"onUpdate:modelValue":t=>s.scientific_name=t,id:`measure-scientific-name-${r}`,"error-message":($=p.errors.scientific_name)==null?void 0:$.message,required:""},null,8,["modelValue","onUpdate:modelValue","id","error-message"])]),e("div",null,[i(u,{label:"Unit",name:"measure_unit",modelValue:s.unit,"onUpdate:modelValue":t=>s.unit=t,id:`measure-unit-${r}`,"error-message":(A=p.errors.unit)==null?void 0:A.message},null,8,["modelValue","onUpdate:modelValue","id","error-message"])]),i(ie,{name:"measure-type",label:"Type",hideNotSelected:!0,options:V.value.map(t=>({...t,label:t.name})),modelValue:s.measure_type_id,"onUpdate:modelValue":t=>s.measure_type_id=t,onChange:t=>X(t,r)},null,8,["options","modelValue","onUpdate:modelValue","onChange"]),e("div",we,[o[1]||(o[1]=e("label",{for:"description",class:"block font-medium text-gray-700 mb-1"},"Description",-1)),e("div",ke,[i(U,{theme:"snow",class:"editor",content:s.description,"onUpdate:content":t=>s.description=t,contentType:"html"},null,8,["content","onUpdate:content"])])]),e("div",null,[o[2]||(o[2]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"LOINC Code",-1)),c(e("input",{id:`measure-loinc-code-${r}`,name:"measure_loinc_code","onUpdate:modelValue":t=>s.loinc_code=t,type:"text",required:"",class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,Ve),[[g,s.loinc_code]])]),e("div",null,[o[3]||(o[3]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"MOH Code",-1)),c(e("input",{id:`measure-moh-code-${r}`,name:"measure_moh_code","onUpdate:modelValue":t=>s.moh_code=t,type:"text",required:"",class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,Ce),[[g,s.moh_code]])])]),e("div",Ue,[e("div",Me,[o[4]||(o[4]=e("h4",{class:"font-medium text-lg text-gray-700"},"Reference Ranges",-1)),e("button",{type:"button",onClick:t=>Z(r),class:"px-3 py-1 cursor-pointer bg-emerald-100 text-emerald-700 rounded hover:bg-emerald-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 text-sm"}," Add Range ",8,Re)]),(n(!0),l(M,null,L(s.measure_ranges_attributes,(t,B)=>{var q,D,H,O,F;return n(),l("div",{class:"bg-white rounded border border-gray-200 mb-3 px-5 py-4",key:t.id},[e("div",Se,[e("div",Te,[o[5]||(o[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"50",viewBox:"0 0 24 24"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 6h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2m1 2.5h1.5m1.5 0H6.5m0 0v7m0 0H5m1.5 0H8"})],-1)),e("div",null,[e("h3",je,[x(k(S.value.name)+" Range ("+k(B+1)+") ",1),e("p",Ne,k(S.value.description),1)])])]),e("button",{type:"button",onClick:d=>I(r,B),class:"text-red-600 cursor-pointer hover:text-red-800 flex items-center"},o[6]||(o[6]=[e("svg",{class:"mr-1",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[e("g",{fill:"none"},[e("circle",{cx:"12",cy:"12",r:"9",fill:"currentColor","fill-opacity":"0.25"}),e("path",{stroke:"currentColor","stroke-width":"1.2",d:"M8 12h8"})])],-1),x(" Remove ")]),8,$e)]),((H=(D=(q=C(s.measure_type_id))==null?void 0:q.structure)==null?void 0:D.type)==null?void 0:H.toLowerCase())==="ranges"?(n(),l("div",Ae,[e("div",null,[o[7]||(o[7]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Age Min",-1)),"age_min"in t?c((n(),l("input",{key:0,type:"number",name:"min_age","onUpdate:modelValue":d=>t.age_min=d,id:String(t==null?void 0:t.id),class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,Be)),[[g,t.age_min]]):b("",!0)]),e("div",null,[o[8]||(o[8]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Age Max",-1)),"age_max"in t?c((n(),l("input",{key:0,type:"number",name:"max_age","onUpdate:modelValue":d=>t.age_max=d,id:String(t==null?void 0:t.id),class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,qe)),[[g,t.age_max]]):b("",!0)]),e("div",null,[o[9]||(o[9]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Range Lower",-1)),"range_lower"in t?c((n(),l("input",{key:0,type:"number",name:"range_lower","onUpdate:modelValue":d=>t.range_lower=d,id:String(t==null?void 0:t.id),class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,De)),[[g,t.range_lower]]):b("",!0)]),e("div",null,[o[10]||(o[10]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Range Upper",-1)),"range_upper"in t?c((n(),l("input",{key:0,type:"number",name:"range_upper","onUpdate:modelValue":d=>t.range_upper=d,id:String(t==null?void 0:t.id),class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,He)),[[g,t.range_upper]]):b("",!0)]),e("div",null,[o[12]||(o[12]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Sex",-1)),"sex"in t?c((n(),l("select",{key:0,name:"sex","onUpdate:modelValue":d=>t.sex=d,class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},o[11]||(o[11]=[e("option",{value:"Male"},"Male",-1),e("option",{value:"Female"},"Female",-1),e("option",{value:"Both"},"Both",-1)]),8,Oe)),[[le,t.sex]]):b("",!0)])])):((F=(O=C(s.measure_type_id))==null?void 0:O.structure)==null?void 0:F.type)==="options"?(n(),l("div",Fe,[e("div",null,[o[13]||(o[13]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Value",-1)),c((n(),l("input",{name:"value",key:String(t.id),"onUpdate:modelValue":d=>t.value=d,class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,Ee)),[[g,t.value]])]),e("div",null,[o[14]||(o[14]=e("label",{class:"block text-base font-medium text-gray-700 mb-2"},"Interpretation",-1)),c((n(),l("input",{name:"interpretation","onUpdate:modelValue":d=>t.interpretation=d,key:String(t.id),class:"w-full px-3 py-1 border border-gray-200 text-base placeholder-gray-400 rounded focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:text-gray-500 text-gray-900 transition duration-200"},null,8,Le)),[[g,t.interpretation]])])])):b("",!0)])}),128))])])}),128)),p.testCatalog.measures.length==0?(n(),l("div",Ye,o[15]||(o[15]=[ne('<svg class="w-auto h-24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none"><path fill="currentColor" fill-opacity="0.16" d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2"></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="1.5" d="M12 16h.008M12 8v5m10-1c0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10s10-4.477 10-10"></path></g></svg><p class="text-base"> Please add atleast one measure to continue</p>',2)]))):b("",!0)])]),i(y(be),{show:h.value,as:"template"},{default:_(()=>[i(y(ue),{as:"div",class:"fixed inset-0 z-10 overflow-y-auto"},{default:_(()=>[e("div",ze,[i(y(me),{class:"fixed inset-0 bg-black opacity-30"}),o[19]||(o[19]=e("span",{class:"inline-block h-screen align-middle","aria-hidden":"true"},"â€‹",-1)),i(y(ce),{class:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg"},{default:_(()=>[i(y(pe),{class:"text-lg font-medium leading-6 text-gray-900"},{default:_(()=>o[17]||(o[17]=[x(" Changing measure type will reset existing ranges. ")])),_:1}),i(y(ge),{class:"mt-2 text-lg text-gray-500"},{default:_(()=>o[18]||(o[18]=[x(" Do you want to continue? ")])),_:1}),e("div",{class:"mt-4 flex justify-end space-x-4"},[e("button",{onClick:K,class:"bg-emerald-600 cursor-pointer text-white px-4 py-2 rounded"},"Yes"),e("button",{onClick:Q,class:"bg-gray-200 cursor-pointer text-gray-900 px-4 py-2 rounded"},"No")])]),_:1})])]),_:1})]),_:1},8,["show"])],64)}}});export{We as default};
